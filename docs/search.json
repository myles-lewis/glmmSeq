[{"path":"/articles/glmmSeq.html","id":"glmmseq","dir":"Articles","previous_headings":"","what":"glmmSeq","title":"glmmSeq","text":"aim package model gene expression general linear mixed model (GLMM) described R4RA study [1]. widely used mainstream differential gene expression analysis tools (e.g Limma, DESeq2, edgeR) unable fit mixed effects linear models. package however fits negative binomial mixed effects models individual gene level using negative.binomial function MASS glmer function lme4 enables random effect, well mixed effects, modelled.","code":""},{"path":"/articles/glmmSeq.html","id":"installing-from-cran","dir":"Articles","previous_headings":"glmmSeq","what":"Installing from CRAN","title":"glmmSeq","text":"","code":"install.packages(\"glmmSeq\")"},{"path":"/articles/glmmSeq.html","id":"installing-from-github","dir":"Articles","previous_headings":"glmmSeq","what":"Installing from Github","title":"glmmSeq","text":"","code":"devtools::install_github(\"myles-lewis/glmmSeq\")"},{"path":"/articles/glmmSeq.html","id":"installing-locally","dir":"Articles","previous_headings":"glmmSeq","what":"Installing Locally","title":"glmmSeq","text":"can source functions individually: need load additional libraries:","code":"functions = list.files(\"./R\", full.names = TRUE) invisible(lapply(functions, source)) # Install CRAN packages invisible(lapply(c(\"MASS\", \"car\", \"ggplot2\", \"ggpubr\", \"lme4\",\"lmerTest\",                    \"methods\", \"parallel\", \"plotly\", \"pbapply\", \"pbmcapply\"),                  function(p){                    if(! p %in% rownames(installed.packages())) {                      install.packages(p)                    }                    library(p, character.only=TRUE)                  }))  # Install BioConductor packages if (!requireNamespace(\"BiocManager\", quietly = TRUE))   install.packages(\"BiocManager\") invisible(lapply(c(\"qvalue\"), function(p){   if(! p %in% rownames(installed.packages())) BiocManager::install(p)   library(p, character.only=TRUE) }))"},{"path":"/articles/glmmSeq.html","id":"overview","dir":"Articles","previous_headings":"","what":"Overview","title":"glmmSeq","text":"get started, first load package: vignette demonstrate power package using minimal example PEAC data set. focus synovial biopsy RNA-Seq data cohort patients early rheumatoid arthritis. data contains: metadata: describes sample. Including patient ID, sample time-point, six-month EULAR response. EULAR rheumatoid arthritis response metric based composite DAS28 scores. tpm: transcript per million RNA-seq count data outlined following subsections.","code":"library(glmmSeq) set.seed(1234) data(PEAC_minimal_load)"},{"path":"/articles/glmmSeq.html","id":"metadata","dir":"Articles","previous_headings":"Overview","what":"Metadata","title":"glmmSeq","text":"","code":"metadata$EULAR_binary  = NA metadata$EULAR_binary[metadata$EULAR_6m %in%                         c(\"Good\", \"Moderate\" )] = \"responder\" metadata$EULAR_binary[metadata$EULAR_6m %in% c(\"Non-response\")] = \"non_responder\"  kable(head(metadata), row.names = F) %>% kable_styling()"},{"path":"/articles/glmmSeq.html","id":"count-data","dir":"Articles","previous_headings":"Overview","what":"Count data","title":"glmmSeq","text":"","code":"kable(head(tpm)) %>% kable_styling() %>%   scroll_box(width = \"100%\")"},{"path":"/articles/glmmSeq.html","id":"dispersion","dir":"Articles","previous_headings":"Overview","what":"Dispersion","title":"glmmSeq","text":"Using negative binomial models requires gene dispersion estimates made. can achieved number ways. common way calculate gene use equation: Dispersioni = (variancei - meani)/meani2 can calculated using: Alternatively, recommend using edgeR estimate common, trended tagwise dispersions across tags: DESeq2 using raw counts:","code":"disp <- apply(tpm, 1, function(x){   (var(x, na.rm=TRUE)-mean(x, na.rm=TRUE))/(mean(x, na.rm=TRUE)**2)   })  head(disp) ##     MS4A1    ADAM12 IGHV7-4-1  IGHV3-49  IGHV3-23  ADAM12.1  ##  3.789428  2.391912 11.686420 10.863156  3.262557  2.391912 disp  <- setNames(edgeR::estimateDisp(tpm)$tagwise.dispersion, rownames(tpm))  head(disp) dds <- DESeqDataSetFromTximport(txi = txi, colData = metadata, design = ~ 1) dds <- DESeq(dds) dispersions <- setNames(dispersions(dds), rownames(txi$counts))"},{"path":"/articles/glmmSeq.html","id":"size-factors","dir":"Articles","previous_headings":"Overview","what":"Size Factors","title":"glmmSeq","text":"also option include size factors gene. can estimated using: using edgeR can calculated raw read counts: Similarly, DESeq2: Note sizeFactors vector needs centred around 1, since used directly offset form log(sizeFactors) GLMM model.","code":"sizeFactors <- colSums(tpm)   sizeFactors <- sizeFactors / mean(sizeFactors)  # normalise to mean = 1  head(sizeFactors) ##      S9001      S9002      S9003      S9004      S9006      S9007  ## 0.20325747 0.09330435 0.09737100 3.13456671 0.24515015 4.19419297 sizeFactors <- calcNormFactors(counts, method=\"TMM\") sizeFactors <- estimateSizeFactorsForMatrix(counts)"},{"path":"/articles/glmmSeq.html","id":"fitting-models","dir":"Articles","previous_headings":"","what":"Fitting Models","title":"glmmSeq","text":"fit model one gene time use formula : gene expression ~ fixed effects + random effects R formula defined fixed-effects random-effects part model, response left ~ operator terms, separated + operators, right. Random-effects terms distinguished vertical bars (“|”) separating expressions design matrices grouping factors. information see ?lme4::glmer. case study want use time response fixed effects patients random effects: gene expression ~ time + response + (1 | patient) fit model genes can use glmmSeq function. Note analysis can take time, 4 cores: 1000 genes takes 10 seconds 20000 genes takes 4 mins alternatively using two-factor classification EULAR_binary:","code":"results <- glmmSeq(~ Timepoint * EULAR_6m + (1 | PATID),                    countdata = tpm,                    metadata = metadata,                    dispersion = disp,                    progress = TRUE) ##  ## n = 123 samples, 82 individuals ## Time difference of 3.224622 secs ## Errors in 4 gene(s): IL12A, FGF12, VIL1, IL26 results2 <- glmmSeq(~ Timepoint * EULAR_binary + (1 | PATID),                     countdata = tpm,                     metadata = metadata,                     dispersion = disp) ##  ## n = 123 samples, 82 individuals ## Time difference of 3.004652 secs ## Errors in 4 gene(s): IL12A, FGF12, VIL1, IL26"},{"path":"/articles/glmmSeq.html","id":"outputs","dir":"Articles","previous_headings":"Fitting Models","what":"Outputs","title":"glmmSeq","text":"creates GlmmSeq object contains following slots: variables used model @modeldata: model fit statistics can viewed @stats slot list items including fitted model coefficients, standard errors results statistical tests terms within model using Wald type 2 Chi square. see significant interactions can order pvals Timepoint:EULAR_6m: Summary statistics single gene can shown specifying argument gene. Estimated means based gene’s fitted model show fixed effects 95% confidence intervals can seen @predict slot:","code":"names(attributes(results)) ##  [1] \"info\"      \"formula\"   \"stats\"     \"predict\"   \"reduced\"   \"countdata\" \"metadata\"  ##  [8] \"modelData\" \"optInfo\"   \"errors\"    \"vars\"      \"class\" kable(results@modelData) %>% kable_styling() stats <- summary(results)  kable(stats[order(stats[, 'P_Timepoint:EULAR_6m']), ]) %>%   kable_styling() %>%   scroll_box(width = \"100%\", height = \"400px\") summary(results, gene = \"MS4A1\") ## Generalised linear mixed model ## Method: lme4 ## Family: Negative Binomial ## Formula: count ~ Timepoint + EULAR_6m + (1 | PATID) + Timepoint:EULAR_6m ##  Dispersion         AIC      logLik     meanExp  ##    3.789428  898.682864 -441.341432    2.591740  ##  ## Fixed effects: ##                                Estimate Std. Error ## (Intercept)                     2.73637    0.33669 ## Timepoint                       0.04908    0.08941 ## EULAR_6mModerate                0.19330    0.51103 ## EULAR_6mNon-response           -1.72376    0.67780 ## Timepoint:EULAR_6mModerate     -0.21080    0.13478 ## Timepoint:EULAR_6mNon-response  0.17462    0.16558 ##  ## Analysis of Deviance Table (Type II Wald chisquare tests) ##                      Chisq Df Pr(>Chisq) ## Timepoint          0.01125  1    0.91554 ## EULAR_6m           5.68288  2    0.05834 ## Timepoint:EULAR_6m 5.43787  2    0.06594 predict = data.frame(results@predict) kable(predict) %>%   kable_styling() %>%   scroll_box(width = \"100%\", height = \"400px\")"},{"path":"/articles/glmmSeq.html","id":"q-values","dir":"Articles","previous_headings":"Fitting Models","what":"Q-values","title":"glmmSeq","text":"q-values p-value columns can calculated using glmmQvals. print significance table based cut-(default p=0.05) add matrix named qvals @stats slot:","code":"results <- glmmQvals(results) ##  ## Timepoint ## --------- ## Not Significant     Significant  ##              29              17  ##  ## EULAR_6m ## -------- ## Not Significant     Significant  ##              41               5  ##  ## Timepoint:EULAR_6m ## ------------------ ## Not Significant  ##              46"},{"path":"/articles/glmmSeq.html","id":"glmmtmb-models","dir":"Articles","previous_headings":"","what":"glmmTMB models","title":"glmmSeq","text":"glmmTMB package alternative lme4 fitting negative binomial GLMM models. Note, package optimises dispersion parameter GLMM model. advantage predefined list dispersions gene required. also means model fitting significantly slower negative binomial GLMM fit lme4::glmer family function MASS::negative.binomial dispersion parameter must pre-specified. glmmTMB model takes 0.8 seconds, even 8 cores, typical transcriptome 20,000 genes take 30 minutes, although vary depending complexity design formula. comparison, standard glmer pipeline known dispersions supplied takes 2 minutes 8 cores. Although glmmTMB slower lme::glmer known dispersion, glmmTMB still faster equivalent lme4 function glmer.nb dispersion unknown. Setting method = \"glmmTMB\" calling glmmSeq() switches using lme4::glmer (default) glmmTMB package. dispersion argument longer required. family argument can used specify different family functions glmmTMB provides nbinom1 nbinom2 (glmmSeq uses latter default). family functions e.g. poisson can used.","code":""},{"path":"/articles/glmmSeq.html","id":"gaussian-mixed-effects-models","dir":"Articles","previous_headings":"","what":"Gaussian mixed effects models","title":"glmmSeq","text":"alternative fitting negative binomial GLMM use transformed data fit gaussian LMM. lmmSeq function fit many LMM across genes (data) random effects/mixed effects models useful. almost 3x faster glmmSeq. example, gaussian normalised DNA methylation data can analysed using method. example RNA-Seq gene expression data log transformed approximately Gaussian. Alternatively variance stabilising transformation (VST) can applied count data DESeq2 voom transformation limma voom.","code":"logtpm <- log2(tpm + 1) lmmres <- lmmSeq(~ Timepoint * EULAR_6m + (1 | PATID),                    maindata = logtpm,                    metadata = metadata,                    progress = TRUE) ##  ## n = 123 samples, 82 individuals ## Time difference of 0.7843871 secs summary(lmmres, \"MS4A1\") ## Linear mixed model ## Formula: gene ~ Timepoint + EULAR_6m + (1 | PATID) + Timepoint:EULAR_6m ##         AIC      logLik     meanExp  ##  503.415984 -243.707992    2.590358  ##  ## Fixed effects: ##                                 Estimate Std. Error ## (Intercept)                     2.614919    0.30012 ## Timepoint                       0.024789    0.06841 ## EULAR_6mModerate                0.860136    0.45592 ## EULAR_6mNon-response           -0.983157    0.58504 ## Timepoint:EULAR_6mModerate     -0.256884    0.10233 ## Timepoint:EULAR_6mNon-response -0.009612    0.12407 ##  ## Analysis of Deviance Table (Type II Wald chisquare tests) ##                    Chisq Df Pr(>Chisq) ## Timepoint          2.321  1    0.12767 ## EULAR_6m           6.098  2    0.04740 ## Timepoint:EULAR_6m 7.134  2    0.02823"},{"path":"/articles/glmmSeq.html","id":"hypothesis-testing","dir":"Articles","previous_headings":"","what":"Hypothesis testing","title":"glmmSeq","text":"default, p-values model term computed using Wald type 2 Chi-squared test per car::Anova(). underlying code optimised speed. LMM via lmmSeq(), alternative Wald type 2 Chi-squared test F-test Satterthwaite denominator degrees freedom, implemented using lmerTest package enabled using test.stat = \"F\". available GLMM. However, reduced model formula specified setting reduced, likelihood ratio test performed instead using anova. double computation time since two (G)LMM fitted gene. information inference testing GLMM, recommend Ben Bolker’s GLMM FAQ page.","code":"glmmLRT <- glmmSeq(~ Timepoint * EULAR_6m + (1 | PATID),                    reduced = ~ Timepoint + EULAR_6m + (1 | PATID),                    countdata = tpm,                    metadata = metadata,                    dispersion = disp, verbose = FALSE)  summary(glmmLRT, \"MS4A1\") ## Generalised linear mixed model ## Method: lme4 ## Family: Negative Binomial ## Formula: count ~ Timepoint + EULAR_6m + (1 | PATID) + Timepoint:EULAR_6m ##  Dispersion         AIC      logLik     meanExp  ##    3.789428  898.682864 -441.341432    2.591740  ##  ## Fixed effects: ##                                Estimate Std. Error ## (Intercept)                     2.73637    0.33669 ## Timepoint                       0.04908    0.08941 ## EULAR_6mModerate                0.19330    0.51103 ## EULAR_6mNon-response           -1.72376    0.67780 ## Timepoint:EULAR_6mModerate     -0.21080    0.13478 ## Timepoint:EULAR_6mNon-response  0.17462    0.16558 ##  ## Likelihood ratio test ## Reduced formula: count ~ Timepoint + EULAR_6m + (1 | PATID) ##   Chisq Df Pr(>Chisq) ##    4.85  2    0.08846"},{"path":"/articles/glmmSeq.html","id":"extracting-individual-genes","dir":"Articles","previous_headings":"","what":"Extracting individual Genes","title":"glmmSeq","text":"Similarly can run script individual gene (make sure use drop = FALSE maintain countdata matrix). (g)lmer glmmTMB fitted object single gene can obtained using function glmmRefit(): (g)lmer objects can passed packages notably emmeans visualising estimated marginal means. Note based model, directly data.","code":"MS4A1glmm <- glmmSeq(~ Timepoint * EULAR_6m + (1 | PATID),                      countdata = tpm[\"MS4A1\", , drop = FALSE],                      metadata = metadata,                      dispersion = disp,                      verbose = FALSE) fit <- glmmRefit(results, gene = \"MS4A1\") ## boundary (singular) fit: see help('isSingular') fit ## Generalized linear mixed model fit by maximum likelihood (Laplace Approximation) [ ## glmerMod] ##  Family: Negative Binomial(0.2639)  ( log ) ## Formula: count ~ Timepoint + EULAR_6m + (1 | PATID) + Timepoint:EULAR_6m ##    Data: data ##  Offset: offset ##       AIC       BIC    logLik  deviance  df.resid  ##  898.6829  921.1803 -441.3414  882.6829       115  ## Random effects: ##  Groups Name        Std.Dev. ##  PATID  (Intercept) 0        ## Number of obs: 123, groups:  PATID, 82 ## Fixed Effects: ##                    (Intercept)                       Timepoint   ##                        2.73637                         0.04908   ##               EULAR_6mModerate            EULAR_6mNon-response   ##                        0.19330                        -1.72376   ##     Timepoint:EULAR_6mModerate  Timepoint:EULAR_6mNon-response   ##                       -0.21080                         0.17462   ## optimizer (bobyqa) convergence code: 0 (OK) ; 0 optimizer warnings; 1 lme4 warnings library(emmeans)  emmeans(fit, ~ Timepoint | EULAR_6m) ## EULAR_6m = Good: ##  Timepoint emmean    SE  df asymp.LCL asymp.UCL ##          0   2.74 0.337 Inf      2.08      3.40 ##          6   3.03 0.418 Inf      2.21      3.85 ##  ## EULAR_6m = Moderate: ##  Timepoint emmean    SE  df asymp.LCL asymp.UCL ##          0   2.93 0.384 Inf      2.18      3.68 ##          6   1.96 0.467 Inf      1.04      2.88 ##  ## EULAR_6m = Non-response: ##  Timepoint emmean    SE  df asymp.LCL asymp.UCL ##          0   1.01 0.588 Inf     -0.14      2.17 ##          6   2.35 0.594 Inf      1.19      3.52 ##  ## Results are given on the log (not the response) scale.  ## Confidence level used: 0.95 emmip(fit, ~ Timepoint | EULAR_6m)"},{"path":"/articles/glmmSeq.html","id":"refitting-a-different-model","dir":"Articles","previous_headings":"Extracting individual Genes","what":"Refitting a different model","title":"glmmSeq","text":"glmmRefit() allows different model fitted using original data. example shows refit model without interaction term perform likelihood ratio test using anova. Note glmmSeq() objects LHS reduced formula must \"count\", lmmSeq() objects LHS must \"gene\". glmmTMB analyses, GLM family can also changed.","code":"fit2 <- glmmRefit(results, gene = \"MS4A1\",                   formula = count ~ Timepoint + EULAR_6m + (1 | PATID))  anova(fit, fit2) ## Data: data ## Models: ## fit2: count ~ Timepoint + EULAR_6m + (1 | PATID) ## fit: count ~ Timepoint + EULAR_6m + (1 | PATID) + Timepoint:EULAR_6m ##      npar    AIC    BIC  logLik deviance  Chisq Df Pr(>Chisq)   ## fit2    6 899.53 916.41 -443.77   887.53                        ## fit     8 898.68 921.18 -441.34   882.68 4.8505  2    0.08846 . ## --- ## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1"},{"path":"/articles/glmmSeq.html","id":"model-plots","dir":"Articles","previous_headings":"","what":"Model Plots","title":"glmmSeq","text":"variables time, matched according ID (random effect), can examine fitted model using plots show estimated means confidence intervals based coefficients fitted regression model, overlaid upon underlying data. case samples matched longitudinally time. Plots can viewed using either ggplot base graphics. can start looking gene significant interaction IGHV3-23:  Alternatively plots can generated using base graphics, without model fit overlaid. default p-value labels taken column names pvals object stats slot S4 result object. can relabelled using plab argument.  plot model fits alone set addPoints = FALSE.","code":"plotColours <- c(\"skyblue\", \"goldenrod1\", \"mediumseagreen\") modColours <- c(\"dodgerblue3\", \"goldenrod3\", \"seagreen4\") shapes <- c(17, 19, 18)  ggmodelPlot(results,             geneName = \"IGHV3-23\",             x1var = \"Timepoint\",             x2var=\"EULAR_6m\",             xlab=\"Time\",             colours = plotColours,             shapes = shapes,             lineColours = plotColours,              modelColours = modColours,             modelSize = 10) oldpar <- par(mfrow=c(1, 2))  modelPlot(results2,           geneName = \"FGF14\",           x1var = \"Timepoint\",           x2var=\"EULAR_binary\",           fontSize=0.65,           colours=c(\"coral\", \"mediumseagreen\"),           modelColours = c(\"coral\", \"mediumseagreen\"),           modelLineColours = \"black\",           modelSize = 2)  modelPlot(results,           geneName = \"EMILIN3\",           x1var = \"Timepoint\",           x2var = \"EULAR_6m\",           colours = plotColours,           plab = c(\"time\", \"response\", \"time:response\"),           addModel = FALSE) par(oldpar) library(ggpubr)  p1 <- ggmodelPlot(results,                   \"ADAM12\",                   x1var=\"Timepoint\",                   x2var=\"EULAR_6m\",                   xlab=\"Time\",                   addPoints = FALSE,                   colours = plotColours)  p2 <- ggmodelPlot(results,                   \"EMILIN3\",                   x1var=\"Timepoint\",                   x2var=\"EULAR_6m\",                   xlab=\"Time\",                   fontSize=8,                   x2Offset=1,                   addPoints = FALSE,                   colours = plotColours)  ggarrange(p1, p2, ncol=2, common.legend = T, legend=\"bottom\")"},{"path":"/articles/glmmSeq.html","id":"fold-change-plots","dir":"Articles","previous_headings":"Model Plots","what":"Fold change plots","title":"glmmSeq","text":"comparative fold change (x1var variables) conditions (x2var x2Values variables) can plotted using fcPlot genes highlight significance. type plot suited look interaction time (x1var) two-level factor (x2var), looking change two timepoints. example R4RA study [1], gene expression pre- post-drug treatment compared two drugs (rituximab & tocilizumab), using design formula gene_counts ~ time * drug. setting graphics = \"plotly\" can viewed interactively.  Log2 fold change two time points individuals treated rituximab x axis individuals treated tocilizumab y axis point representing gene. Genes showing interaction time drug coloured blue gold depending whether fold change greater post-rituximab (blue) post-tocilizumab (gold). Genes without interaction, changing significantly time coloured green tend lie along line identity. See Longitudinal tab https://r4ra.hpc.qmul.ac.uk interactive version plot.","code":"r4ra_glmm <- glmmSeq(~ time * drug + (1 | Patient_ID),                         countdata = tpmdata, metadata,                        dispersion = dispersions, cores = 8, removeSingles = T) r4ra_glmm <- glmmQvals(r4ra_glmm) labels = c(..)  # Genes to label fcPlot(r4ra_glmm, x1var = \"time\", x2var = \"drug\", graphics = \"plotly\",        pCutoff = 0.05, useAdjusted = TRUE,        labels = labels,        colours = c('grey', 'green3', 'gold3', 'blue'))"},{"path":"/articles/glmmSeq.html","id":"ma-plots","dir":"Articles","previous_headings":"Model Plots","what":"MA plots","title":"glmmSeq","text":"MA plot application Bland–Altman plot. plot visualizes differences measurements taken two samples, transforming data onto M (log ratio) (mean average) scales, plotting values.","code":"labels = c('MS4A1', 'FGF14', 'IL2RG', 'IGHV3-23', 'ADAM12', 'IL36G',             'BLK', 'SAA1', 'CILP', 'EMILIN3', 'EMILIN2', 'IGHJ6',             'CXCL9', 'CXCL13') maPlots <- maPlot(results,                   x1var=\"Timepoint\",                   x2var=\"EULAR_6m\",                   x2Values=c(\"Good\", \"Non-response\"),                   colours=c('grey', 'midnightblue',                              'mediumseagreen', 'goldenrod'),                   labels=labels,                   graphics=\"ggplot\")  maPlots$combined"},{"path":"/articles/glmmSeq.html","id":"troubleshooting","dir":"Articles","previous_headings":"","what":"Troubleshooting","title":"glmmSeq","text":"Mixed effects models tricky fit lme4::glmer sometimes returns errors. fact, significant amount code glmmSeq devoted catching handling errors allow parallelisation continue. Errors genes stored errors slot. Sometimes glmmSeq returns errors genes. usually means problem enough samples timepoint mistake formula. Since version 0.5.5 glmmSeq now returns vector error messages genes, can useful debugging. example , timepoint 0 specified. errors caught error checking core mechanism, can lead problems grouping results core models fit. Setting returnList=TRUE calling glmmSeq returns list output direct mclapply (parLapply windows). can helpful debugging unforeseeen problems core loop.","code":"results@errors[1]   # first gene error ##                                                                                                                         IL12A  ## \"Error in (function (fr, X, reTrms, family, nAGQ = 1L, verbose = 0L, maxit = 100L,  : \\n  PIRLS loop resulted in NaN value\\n\" results3 <- glmmSeq(~ Timepoint * EULAR_6m + (1 | PATID),                     countdata = tpm[, metadata$Timepoint == 0],                     metadata = metadata[metadata$Timepoint == 0, ],                     dispersion = disp) ##  ## n = 72 samples, 72 individuals ## All genes returned an error. Check call. Check sufficient data in each group ##                                                                              MS4A1  ## \"fixed-effect model matrix is rank deficient so dropping 3 columns / coefficients\""},{"path":"/articles/glmmSeq.html","id":"citing-glmmseq","dir":"Articles","previous_headings":"","what":"Citing glmmSeq","title":"glmmSeq","text":"glmmSeq developed bioinformatics team Experimental Medicine & Rheumatology department Centre Translational Bioinformatics Queen Mary University London. use package please cite :","code":"citation(\"glmmSeq\") ##  ## To cite package 'glmmSeq' in publications use: ##  ##   Lewis M, Goldmann K, Sciacca E (????). _glmmSeq: General Linear Mixed Models ##   for Gene-Level Differential Expression_. R package version 0.5.5, ##   <https://github.com/myles-lewis/glmmSeq>. ##  ## A BibTeX entry for LaTeX users is ##  ##   @Manual{, ##     title = {glmmSeq: General Linear Mixed Models for Gene-Level Differential Expression}, ##     author = {Myles Lewis and Katriona Goldmann and Elisabetta Sciacca}, ##     note = {R package version 0.5.5}, ##     url = {https://github.com/myles-lewis/glmmSeq}, ##   }"},{"path":"/articles/glmmSeq.html","id":"references","dir":"Articles","previous_headings":"","what":"References","title":"glmmSeq","text":"Felice Rivellese, Anna Surace, Katriona Goldmann, Elisabetta Sciacca, Cankut Cubuk, Giovanni Giorli, … Michael Barnes, Myles J. Lewis, Costantino Pitzalis, R4RA collaborative group. Rituximab versus tocilizumab rheumatoid arthritis: synovial biopsy-based biomarker analysis phase 4 R4RA randomized trial. Nature medicine 2022; 28(6): 1256-68. doi:10.1038/s41591-022-01789-0 Statistical software used package: lme4: Douglas Bates, Martin Maechler, Ben Bolker, Steve Walker (2015). Fitting Linear Mixed-Effects Models Using lme4. Journal Statistical Software, 67(1), 1-48. doi: 10.18637/jss.v067.i01. car: John Fox Sanford Weisberg (2019). {R} Companion Applied Regression, Third Edition. Thousand Oaks CA: Sage. URL: https://socialsciences.mcmaster.ca/jfox/Books/Companion/ MASS: Venables, W. N. & Ripley, B. D. (2002) Modern Applied Statistics S. Fourth Edition. Springer, New York. ISBN 0-387-95457-0 glmmTMB: Mollie Brooks, Ben Bolker, Kasper Kristensen, Martin Maechler, Arni Magnusson (2022). glmmTMB: Generalized Linear Mixed Models using Template Model Builder qvalue: John D. Storey, Andrew J. Bass, Alan Dabney David Robinson (2020). qvalue: Q-value estimation false discovery rate control. R package version 2.22.0. https://github.com/StoreyLab/qvalue lmerTest: Alexandra Kuznetsova, Per Brockhoff, Rune Christensen, Sofie Jensen. lmerTest: Tests Linear Mixed Effects Models emmeans: Russell V. Lenth, Paul Buerkner, Maxime Herve, Jonathon Love, Fernando Miguez, Hannes Riebl, Henrik Singmann. emmeans: Estimated Marginal Means, aka Least-Squares Means","code":""},{"path":"/authors.html","id":null,"dir":"","previous_headings":"","what":"Authors","title":"Authors and Citation","text":"Myles Lewis. Author, maintainer. Katriona Goldmann. Author. Elisabetta Sciacca. Author. Cankut Cubuk. Contributor. Anna Surace. Contributor.","code":""},{"path":"/authors.html","id":"citation","dir":"","previous_headings":"","what":"Citation","title":"Authors and Citation","text":"Lewis M, Goldmann K, Sciacca E (2022). glmmSeq: General Linear Mixed Models Gene-Level Differential Expression. R package version 0.5.5, https://github.com/myles-lewis/glmmSeq.","code":"@Manual{,   title = {glmmSeq: General Linear Mixed Models for Gene-Level Differential Expression},   author = {Myles Lewis and Katriona Goldmann and Elisabetta Sciacca},   year = {2022},   note = {R package version 0.5.5},   url = {https://github.com/myles-lewis/glmmSeq}, }"},{"path":"/index.html","id":"glmmseq","dir":"","previous_headings":"","what":"General Linear Mixed Models for Gene-Level Differential Expression","title":"General Linear Mixed Models for Gene-Level Differential Expression","text":"R package designed model gene expression general linear mixed model (GLMM). allows us include random effects well fixed effects. purpose package use glmer function lme4 package fits GLMM. package focuses particular changes genes expression different response treatment groups time.","code":""},{"path":[]},{"path":"/index.html","id":"from-cran","dir":"","previous_headings":"","what":"From CRAN","title":"General Linear Mixed Models for Gene-Level Differential Expression","text":"","code":"install.packages(\"glmmSeq\")"},{"path":"/index.html","id":"from-github","dir":"","previous_headings":"","what":"From Github","title":"General Linear Mixed Models for Gene-Level Differential Expression","text":"","code":"devtools::install_github(\"myles-lewis/glmmSeq\")"},{"path":"/index.html","id":"locally","dir":"","previous_headings":"","what":"Locally","title":"General Linear Mixed Models for Gene-Level Differential Expression","text":"can also download source directory load functions individually: need load additional libraries :","code":"functions = list.files(\"./R\", full.names = TRUE) invisible(lapply(functions, source)) # Install CRAN packages invisible(lapply(c(\"MASS\", \"car\", \"ggplot2\", \"ggpubr\", \"lme4\",                     \"lmerTest\", \"methods\", \"parallel\", \"plotly\",                     \"pbapply\", \"pbmcapply\"),                  function(p){                    if(! p %in% rownames(installed.packages())) {                      install.packages(p)                    }                    library(p, character.only=TRUE)                  }))  # Install BioConductor packages if (!requireNamespace(\"BiocManager\", quietly = TRUE))   install.packages(\"BiocManager\") invisible(lapply(c(\"qvalue\"), function(p){   if(! p %in% rownames(installed.packages())) BiocManager::install(p)   library(p, character.only=TRUE) }))"},{"path":"/index.html","id":"example-script","dir":"","previous_headings":"","what":"Example script","title":"General Linear Mixed Models for Gene-Level Differential Expression","text":"examples see vignette.","code":""},{"path":"/index.html","id":"reference","dir":"","previous_headings":"","what":"Reference","title":"General Linear Mixed Models for Gene-Level Differential Expression","text":"glmmSeq developed bioinformatics team Experimental Medicine & Rheumatology department Centre Translational Bioinformatics Queen Mary University London. use package please cite :","code":"citation(\"glmmSeq\")  ## To cite package ‘glmmSeq’ in publications use: ## ##  Myles Lewis, Katriona Goldmann, Elisabetta Sciacca, Cankut Cubuk and Anna Surace (2021).  ##  glmmSeq: General Linear Mixed Models for Gene-level Differential Expression.  ##  R package version 0.5.4. https://github.com/myles-lewis/glmmSeq ## ## A BibTeX entry for LaTeX users is ## ##  @Manual{, ##    title = {glmmSeq: General Linear Mixed Models for Gene-level Differential Expression}, ##    author = {Myles Lewis and Katriona Goldmann and Elisabetta Sciacca and Cankut Cubuk and Anna Surace}, ##    year = {2022}, ##    note = {R package version 0.5.4}, ##    url = {https://github.com/myles-lewis/glmmSeq}, ##  }"},{"path":"/reference/GlmmSeq-class.html","id":null,"dir":"Reference","previous_headings":"","what":"An S4 class to define the glmmSeq output — GlmmSeq-class","title":"An S4 class to define the glmmSeq output — GlmmSeq-class","text":"S4 class define glmmSeq output","code":""},{"path":"/reference/GlmmSeq-class.html","id":"slots","dir":"Reference","previous_headings":"","what":"Slots","title":"An S4 class to define the glmmSeq output — GlmmSeq-class","text":"info List including matched call, dispersions, offset, designMatrix formula model formula stats Statistics fitted models predict Predicted values reduced Optional reduced formula LRT countdata input expression data count data rows metadata input metadata modelData Model data predictions optInfo Information whether model singular converged errors errors vars List variables stored original call, including id variable (default automatically identified random effect term model) removeSingles argument","code":""},{"path":"/reference/fcPlot.html","id":null,"dir":"Reference","previous_headings":"","what":"Plotly or ggplot fold change plots — fcPlot","title":"Plotly or ggplot fold change plots — fcPlot","text":"Plotly ggplot fold change plots","code":""},{"path":"/reference/fcPlot.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Plotly or ggplot fold change plots — fcPlot","text":"","code":"fcPlot(   object,   x1var,   x2var,   x1Values = NULL,   x2Values = NULL,   pCutoff = 0.01,   labels = c(),   useAdjusted = FALSE,   plotCutoff = 1,   graphics = \"ggplot\",   fontSize = 12,   labelFontSize = 4,   colours = c(\"grey\", \"goldenrod1\", \"red\", \"blue\"),   verbose = FALSE,   ... )"},{"path":"/reference/fcPlot.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Plotly or ggplot fold change plots — fcPlot","text":"object glmmSeq object created glmmSeq::glmmSeq(). x1var name first (inner) x parameter x2var name second (outer) x parameter x1Values Timepoints categories x1var used calculate fold change. NULL first two levels x1var used. x2Values Categories x2var compared x y axis. pCutoff significance cut-colour-coding (default = 0.01) labels Row names indices label plot useAdjusted whether use adjusted p-values (must q-values object). Default = FALSE plotCutoff probes include plot significance cut-(default = 1, markers) graphics Graphics system use: \"ggplot\" \"plotly\" fontSize Font size labelFontSize Font size labels colours Vector colours use significance groups verbose Whether print statistics ... parameters pass plotly ggplot","code":""},{"path":"/reference/fcPlot.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Plotly or ggplot fold change plots — fcPlot","text":"Returns plot fold change x1Values one x2Value subset x axis fold change x2Value y axis.","code":""},{"path":"/reference/fcPlot.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Plotly or ggplot fold change plots — fcPlot","text":"","code":"data(PEAC_minimal_load)  disp <- apply(tpm, 1, function(x) { (var(x, na.rm = TRUE)-mean(x, na.rm = TRUE))/(mean(x, na.rm = TRUE)**2) })  glmmFit <- glmmSeq(~ Timepoint * EULAR_6m + (1 | PATID),                      countdata = tpm[1:5, ],                      metadata = metadata,                      dispersion = disp,                      verbose = FALSE)  fcPlot(object = glmmFit,       x1var = \"Timepoint\",       x2var = \"EULAR_6m\",       x2Values = c(\"Good\", \"Non-response\"),       pCutoff = 0.05,       useAdjusted = FALSE,       plotCutoff = 1,       graphics = \"plotly\")  {\"x\":{\"visdat\":{\"4edb3d9a5c43\":[\"function () \",\"plotlyVisDat\"]},\"cur_data\":\"4edb3d9a5c43\",\"attrs\":{\"4edb3d9a5c43\":{\"x\":{},\"y\":{},\"mode\":\"markers\",\"marker\":{\"size\":8,\"line\":{\"width\":0.75,\"color\":\"white\"}},\"text\":[\"MS4A1\",\"ADAM12\",\"IGHV7-4-1\",\"IGHV3-49\",\"IGHV3-23\"],\"hoverinfo\":\"text\",\"color\":{},\"colors\":[\"grey\",\"goldenrod1\",\"red\",\"blue\"],\"alpha_stroke\":1,\"sizes\":[10,100],\"spans\":[1,20],\"type\":\"scatter\"}},\"layout\":{\"margin\":{\"b\":40,\"l\":60,\"t\":25,\"r\":10},\"xaxis\":{\"domain\":[0,1],\"automargin\":true,\"title\":\"log<sub>2<\\/sub>Fold change 6 vs 0 (EULAR_6m = Good)\",\"color\":\"black\"},\"yaxis\":{\"domain\":[0,1],\"automargin\":true,\"title\":\"log<sub>2<\\/sub>Fold change 6 vs 0 (EULAR_6m = Non-response)\",\"color\":\"black\"},\"font\":{\"size\":12},\"legend\":{\"x\":0,\"y\":1,\"font\":{\"color\":\"black\"}},\"hovermode\":\"closest\",\"showlegend\":true},\"source\":\"A\",\"config\":{\"modeBarButtonsToAdd\":[\"hoverclosest\",\"hovercompare\"],\"showSendToCloud\":false,\"edits\":{\"annotationPosition\":false,\"annotationTail\":true,\"annotationText\":true},\"toImageButtonOptions\":{\"format\":\"svg\"}},\"data\":[{\"x\":[0.402304397173844,-0.836420750437364],\"y\":[1.62012242287442,1.04842131786371],\"mode\":\"markers\",\"marker\":{\"color\":\"rgba(190,190,190,1)\",\"size\":8,\"line\":{\"color\":\"white\",\"width\":0.75}},\"text\":[\"MS4A1\",\"ADAM12\"],\"hoverinfo\":[\"text\",\"text\"],\"type\":\"scatter\",\"name\":\"Not Significant\",\"textfont\":{\"color\":\"rgba(190,190,190,1)\"},\"error_y\":{\"color\":\"rgba(190,190,190,1)\"},\"error_x\":{\"color\":\"rgba(190,190,190,1)\"},\"line\":{\"color\":\"rgba(190,190,190,1)\"},\"xaxis\":\"x\",\"yaxis\":\"y\",\"frame\":null},{\"x\":[-0.710023825674319,-1.4446570289101],\"y\":[-2.70518877096958,-3.66823176181332],\"mode\":\"markers\",\"marker\":{\"color\":\"rgba(255,193,37,1)\",\"size\":8,\"line\":{\"color\":\"white\",\"width\":0.75}},\"text\":[\"IGHV7-4-1\",\"IGHV3-49\"],\"hoverinfo\":[\"text\",\"text\"],\"type\":\"scatter\",\"name\":\"P_Timepoint < 0.05\",\"textfont\":{\"color\":\"rgba(255,193,37,1)\"},\"error_y\":{\"color\":\"rgba(255,193,37,1)\"},\"error_x\":{\"color\":\"rgba(255,193,37,1)\"},\"line\":{\"color\":\"rgba(255,193,37,1)\"},\"xaxis\":\"x\",\"yaxis\":\"y\",\"frame\":null},{\"x\":[-0.18499576274843],\"y\":[-3.64716567160521],\"mode\":\"markers\",\"marker\":{\"color\":\"rgba(255,0,0,1)\",\"size\":8,\"line\":{\"color\":\"white\",\"width\":0.75}},\"text\":\"IGHV3-23\",\"hoverinfo\":\"text\",\"type\":\"scatter\",\"name\":\"P_Timepoint:EULAR_6m < 0.05 (biggest FC in Non-response)\",\"textfont\":{\"color\":\"rgba(255,0,0,1)\"},\"error_y\":{\"color\":\"rgba(255,0,0,1)\"},\"error_x\":{\"color\":\"rgba(255,0,0,1)\"},\"line\":{\"color\":\"rgba(255,0,0,1)\"},\"xaxis\":\"x\",\"yaxis\":\"y\",\"frame\":null}],\"highlight\":{\"on\":\"plotly_click\",\"persistent\":false,\"dynamic\":false,\"selectize\":false,\"opacityDim\":0.2,\"selected\":{\"opacity\":1},\"debounce\":0},\"shinyEvents\":[\"plotly_hover\",\"plotly_click\",\"plotly_selected\",\"plotly_relayout\",\"plotly_brushed\",\"plotly_brushing\",\"plotly_clickannotation\",\"plotly_doubleclick\",\"plotly_deselect\",\"plotly_afterplot\",\"plotly_sunburstclick\"],\"base_url\":\"https://plot.ly\"},\"evals\":[],\"jsHooks\":[]}"},{"path":"/reference/ggmodelPlot.html","id":null,"dir":"Reference","previous_headings":"","what":"Mixed model effects plot using ggplot2 — ggmodelPlot","title":"Mixed model effects plot using ggplot2 — ggmodelPlot","text":"Plot show differences groups time using ggplot2.","code":""},{"path":"/reference/ggmodelPlot.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Mixed model effects plot using ggplot2 — ggmodelPlot","text":"","code":"ggmodelPlot(   object,   geneName = NULL,   x1var = NULL,   x2var = NULL,   x2shift = NULL,   xlab = NULL,   ylab = geneName,   plab = NULL,   title = geneName,   logTransform = is(object, \"GlmmSeq\"),   shapes = 19,   colours = \"grey60\",   lineColours = \"grey60\",   markerSize = 1,   fontSize = 12,   alpha = 0.7,   x2Offset = 5,   addPoints = TRUE,   addModel = TRUE,   modelSize = 4,   modelColours = \"blue\",   modelLineSize = 1,   modelLineColours = modelColours,   addBox = FALSE,   ... )"},{"path":"/reference/ggmodelPlot.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Mixed model effects plot using ggplot2 — ggmodelPlot","text":"object glmmSeq/lmmSeq object created glmmSeq::glmmSeq() glmmSeq::lmmSeq() geneName gene/row name plotted x1var name first (inner) x parameter, typically 'time'. anticipated different values matched ID. x2var name optional second (outer) x parameter, factor. x2shift Amount shift along x axis level x2var. default function arrange level x2var side side. xlab Title x axis ylab Title y axis plab Optional character vector labels p-values. must align column names object@stats$pvals. title Plot title. NULL gene name used logTransform Whether perform log10 transform y axis shapes marker shapes (default=19) colours marker colours vector lineColours line colours (default='grey60') vector markerSize Size markers (default=1) fontSize Plot font size alpha Line marker opacity (default=0.7) x2Offset Vertical adjustment secondary x-axis labels (default=5) addPoints Whether add underlying data points (default=TRUE) addModel Whether add fit model markers (default=TRUE) modelSize Size model points (default=4) modelColours Colour model fit markers (default=\"blue\") vector modelLineSize Size model points (default=1) vector modelLineColours Colour model fit lines addBox Logical whether add boxplots mean IQR ... parameters pass ggplot2::theme().","code":""},{"path":"/reference/ggmodelPlot.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Mixed model effects plot using ggplot2 — ggmodelPlot","text":"Returns paired plot matched samples.","code":""},{"path":"/reference/ggmodelPlot.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Mixed model effects plot using ggplot2 — ggmodelPlot","text":"","code":"data(PEAC_minimal_load)  disp <- apply(tpm, 1, function(x){   (var(x, na.rm=TRUE)-mean(x, na.rm=TRUE))/(mean(x, na.rm=TRUE)**2) })  MS4A1glmm <- glmmSeq(~ Timepoint * EULAR_6m + (1 | PATID),                      countdata = tpm['MS4A1', , drop = FALSE],                      metadata = metadata,                      dispersion = disp,                      verbose = FALSE)  ggmodelPlot(object = MS4A1glmm,            geneName = 'MS4A1',            x1var = 'Timepoint',            x2var = 'EULAR_6m',            colours = c('skyblue', 'goldenrod1', 'mediumvioletred'))"},{"path":"/reference/glmmQvals.html","id":null,"dir":"Reference","previous_headings":"","what":"Glmm Sequencing qvalues — glmmQvals","title":"Glmm Sequencing qvalues — glmmQvals","text":"Add qvalue columns glmmSeq dataframe","code":""},{"path":"/reference/glmmQvals.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Glmm Sequencing qvalues — glmmQvals","text":"","code":"glmmQvals(object, cutoff = 0.05, verbose = TRUE)"},{"path":"/reference/glmmQvals.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Glmm Sequencing qvalues — glmmQvals","text":"object glmmSeq/lmmSeq object created glmmSeq::glmmSeq(). cutoff Prints table showing number probes considered significant pvalue cut-(default=0.05) verbose Logical whether print number significant probes (default=TRUE)","code":""},{"path":"/reference/glmmQvals.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Glmm Sequencing qvalues — glmmQvals","text":"Returns GlmmSeq object results gene-wise general linear mixed models adjusted p-values using qvalue function","code":""},{"path":"/reference/glmmQvals.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Glmm Sequencing qvalues — glmmQvals","text":"","code":"data(PEAC_minimal_load) disp <- apply(tpm, 1, function(x) { (var(x, na.rm=TRUE)-mean(x, na.rm = TRUE))/(mean(x, na.rm = TRUE)**2) }) MS4A1glmm <- glmmSeq(~ Timepoint * EULAR_6m + (1 | PATID),                      countdata = tpm[1:5, ],                      metadata = metadata,                      dispersion = disp[1:5],                      verbose=FALSE) MS4A1glmm <- glmmQvals(MS4A1glmm) #>  #> Timepoint #> --------- #> Not Significant     Significant  #>               2               3  #>  #> EULAR_6m #> -------- #> Not Significant     Significant  #>               3               2  #>  #> Timepoint:EULAR_6m #> ------------------ #> Not Significant  #>               5"},{"path":"/reference/glmmRefit.html","id":null,"dir":"Reference","previous_headings":"","what":"Refit mixed effects model — glmmRefit","title":"Refit mixed effects model — glmmRefit","text":"Based 'GlmmSeq' 'lmmSeq' class result object, function attempts refit identical model specific gene based data fitting parameters stored results object refitting using either lme4::glmer() GlmmSeq objects lmer() lmmSeq objects. fitted model can passed packages emmeans look estimated marginal means model.","code":""},{"path":"/reference/glmmRefit.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Refit mixed effects model — glmmRefit","text":"","code":"glmmRefit(object, gene, ...)  # S3 method for lmmSeq glmmRefit(object, gene, formula = object@formula, ...)  # S3 method for GlmmSeq glmmRefit(   object,   gene,   formula = object@formula,   control = object@info$control,   family = NULL,   ... )"},{"path":"/reference/glmmRefit.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Refit mixed effects model — glmmRefit","text":"object fitted results object class GlmmSeq lmmSeq gene character value specifying single gene extract fitted model ... Optional arguments passed either lme4::glmer() lme4::lmer() formula Optional formula use refitting model control Optional control parameters, see lme4::lmerControl() lme4::glmerControl() family Optional GLM family refitting GLMM using lme4::glmer() glmmTMB()","code":""},{"path":"/reference/glmmRefit.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Refit mixed effects model — glmmRefit","text":"Fitted model class lmerMod case LMM, glmerMod glmmTMB GLMM dependent original method.","code":""},{"path":"/reference/glmmRefit.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Refit mixed effects model — glmmRefit","text":"","code":"data(PEAC_minimal_load) disp <- apply(tpm, 1, function(x) {   (var(x, na.rm = TRUE)-mean(x, na.rm = TRUE))/(mean(x, na.rm = TRUE)**2) }) glmmtest <- glmmSeq(~ Timepoint * EULAR_6m + (1 | PATID),                      countdata = tpm[1:2, ],                      metadata = metadata,                      dispersion = disp,                      verbose = FALSE)  # show summary for single gene summary(glmmtest, \"MS4A1\") #> Generalised linear mixed model #> Method: lme4 #> Family: Negative Binomial #> Formula: count ~ Timepoint + EULAR_6m + (1 | PATID) + Timepoint:EULAR_6m #> <environment: 0x7f9b3b045db8> #>  Dispersion         AIC      logLik     meanExp  #>    3.789428  898.682864 -441.341432    2.591740  #>  #> Fixed effects: #>                                Estimate Std. Error #> (Intercept)                     2.73637    0.33669 #> Timepoint                       0.04908    0.08941 #> EULAR_6mModerate                0.19330    0.51103 #> EULAR_6mNon-response           -1.72376    0.67780 #> Timepoint:EULAR_6mModerate     -0.21080    0.13478 #> Timepoint:EULAR_6mNon-response  0.17462    0.16558 #>  #> Analysis of Deviance Table (Type II Wald chisquare tests) #>                      Chisq Df Pr(>Chisq) #> Timepoint          0.01125  1    0.91554 #> EULAR_6m           5.68288  2    0.05834 #> Timepoint:EULAR_6m 5.43787  2    0.06594  # refit a single model using lme4::glmer() fit <- glmmRefit(glmmtest, \"MS4A1\") #> boundary (singular) fit: see help('isSingular')  # refit model with reduced formula fit2 <- glmmRefit(glmmtest, \"MS4A1\",                   formula = count ~ Timepoint + EULAR_6m + (1 | PATID))  # LRT anova(fit, fit2) #> Data: data #> Models: #> fit2: count ~ Timepoint + EULAR_6m + (1 | PATID) #> fit: count ~ Timepoint + EULAR_6m + (1 | PATID) + Timepoint:EULAR_6m #>      npar    AIC    BIC  logLik deviance  Chisq Df Pr(>Chisq)   #> fit2    6 899.53 916.41 -443.77   887.53                        #> fit     8 898.68 921.18 -441.34   882.68 4.8505  2    0.08846 . #> --- #> Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1"},{"path":"/reference/glmmSeq.html","id":null,"dir":"Reference","previous_headings":"","what":"GLMM with negative binomial distribution for sequencing count data — glmmSeq","title":"GLMM with negative binomial distribution for sequencing count data — glmmSeq","text":"Fits many generalised linear mixed effects models (GLMM) negative binomial distribution analysis overdispersed count data random effects. Designed longitudinal analysis RNA-Sequencing count data.","code":""},{"path":"/reference/glmmSeq.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"GLMM with negative binomial distribution for sequencing count data — glmmSeq","text":"","code":"glmmSeq(   modelFormula,   countdata,   metadata,   id = NULL,   dispersion = NA,   sizeFactors = NULL,   reduced = NULL,   modelData = NULL,   designMatrix = NULL,   method = c(\"lme4\", \"glmmTMB\"),   control = NULL,   family = nbinom2,   cores = 1,   removeSingles = FALSE,   zeroCount = 0.125,   verbose = TRUE,   returnList = FALSE,   progress = FALSE,   ... )"},{"path":"/reference/glmmSeq.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"GLMM with negative binomial distribution for sequencing count data — glmmSeq","text":"modelFormula model formula. must form \"~ ...\" structure assumed \"counts ~ ...\". formula must include random effects term. information formula structure random effects see lme4::glmer() countdata sequencing count data matrix genes rows samples columns metadata dataframe sample information variables columns samples rows id Optional. Used specify column metadata contains sample IDs used repeated samples random effects. specified, function defaults using variable \"|\" random effects term formula. dispersion numeric vector gene dispersion. required glmmTMB models, determine fit dispersion gene. sizeFactors size factors (default = NULL). provided glmer offset set log(sizeFactors). information see`` lme4::glmer() reduced Optional reduced model formula. chosen, likelihood ratio test used calculate p-values instead default Wald type 2 Chi-squared test. modelData Optional dataframe. Default generated call expand.grid using levels variables formula. Used calculate model predictions (estimated means & 95% CI) plotting via modelPlot. can therefore used add/remove points modelPlot. designMatrix custom design matrix, used prediction method Specifies package use fitting GLMM models. Either \"lme4\" \"glmmTMB\" depending whether use lme4::glmer glmmTMB::glmmTMB fit GLMM models. control glmer optimizer control. method = \"lme4\" default glmerControl(optimizer = \"bobyqa\")). method = \"glmmTMB\" default glmmTMBControl() family used glmmTMB models. Default nbinom2. See glmmTMB::nbinom2 cores number cores use. Default = 1. removeSingles whether remove individuals without repeated measures (default = FALSE) zeroCount numerical value offset zeroes purpose log (default = 0.125) verbose Logical whether display messaging (default = TRUE) returnList Logical whether return results list glmmSeq object (default = FALSE). Useful debugging. progress Logical whether display progress bar ... parameters pass lme4::glmer()","code":""},{"path":"/reference/glmmSeq.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"GLMM with negative binomial distribution for sequencing count data — glmmSeq","text":"Returns S4 class GlmmSeq object results gene-wise general linear mixed models. list results returned returnList TRUE useful debugging. genes return errors glmer, error message shown character vector containing error messages genes returned.","code":""},{"path":"/reference/glmmSeq.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"GLMM with negative binomial distribution for sequencing count data — glmmSeq","text":"function wrapper lme4::glmer(). default, p-values model term computed using Wald type 2 Chi-squared test per car::Anova(). underlying code optimised speed. However, reduced model formula specified setting reduced, likelihood ratio test performed instead using stats::anova. double computation time since two GLMM fitted. Parallelisation provided using parallel::mclapply Unix/Mac parallel::parLapply PC. Setting method = \"glmmTMB\" enables alternative method fitting GLMM using glmmTMB package. gives access variety alternative GLM family functions. Note, glmmTMB negative binomial models substantially slower fit glmer models known dispersion due extra time taken glmmTMB optimise dispersion parameter. id argument usually optional. default id column metadata determined term bar random effects term model. Note id passed glmer glmmTMB. really used remove singletons countdata matrix metadata dataframe. id also stored output glmmSeq used plotting function modelPlot(). However, due flexible nature, theory glmmSeq allow one random effect term, although tested formally. case, probably prudent specify value id.","code":""},{"path":[]},{"path":"/reference/glmmSeq.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"GLMM with negative binomial distribution for sequencing count data — glmmSeq","text":"","code":"data(PEAC_minimal_load) disp <- apply(tpm, 1, function(x) { (var(x, na.rm = TRUE)-mean(x, na.rm = TRUE))/(mean(x, na.rm = TRUE)**2) }) MS4A1glmm <- glmmSeq(~ Timepoint * EULAR_6m + (1 | PATID),                      countdata = tpm[1:2, ],                      metadata = metadata,                      dispersion = disp,                      verbose = FALSE) names(attributes(MS4A1glmm)) #>  [1] \"info\"      \"formula\"   \"stats\"     \"predict\"   \"reduced\"   \"countdata\" #>  [7] \"metadata\"  \"modelData\" \"optInfo\"   \"errors\"    \"vars\"      \"class\""},{"path":"/reference/lmmSeq-class.html","id":null,"dir":"Reference","previous_headings":"","what":"An S4 class to define the lmmSeq output — lmmSeq-class","title":"An S4 class to define the lmmSeq output — lmmSeq-class","text":"S4 class define lmmSeq output","code":""},{"path":"/reference/lmmSeq-class.html","id":"slots","dir":"Reference","previous_headings":"","what":"Slots","title":"An S4 class to define the lmmSeq output — lmmSeq-class","text":"info List including matched call, offset, designMatrix formula model formula stats Statistics fitted models predict Predicted values reduced Optional reduced formula LRT maindata input expression data variables rows metadata input metadata modelData Model data predictions optInfo Information whether model singular converged errors errors vars List variables stored original call","code":""},{"path":"/reference/lmmSeq.html","id":null,"dir":"Reference","previous_headings":"","what":"Linear mixed models for data matrix — lmmSeq","title":"Linear mixed models for data matrix — lmmSeq","text":"Fits many linear mixed effects models analysis gaussian data random effects, parallelisation optimisation speed. suitable longitudinal analysis high dimensional data. Wald type 2 Chi-squared test used calculate p-values.","code":""},{"path":"/reference/lmmSeq.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Linear mixed models for data matrix — lmmSeq","text":"","code":"lmmSeq(   modelFormula,   maindata,   metadata,   id = NULL,   offset = NULL,   test.stat = c(\"Wald\", \"F\", \"LRT\"),   reduced = NULL,   modelData = NULL,   designMatrix = NULL,   control = lmerControl(),   cores = 1,   removeSingles = FALSE,   verbose = TRUE,   returnList = FALSE,   progress = FALSE,   ... )"},{"path":"/reference/lmmSeq.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Linear mixed models for data matrix — lmmSeq","text":"modelFormula model formula. must form \"~ ...\" structure assumed \"gene ~ ...\". formula must include random effects term. See formula structure random effects lme4::lmer() maindata data matrix genes rows samples columns metadata dataframe sample information variables columns samples rows id Optional. Used specify column metadata contains sample IDs used repeated samples random effects. specified, function defaults using variable \"|\" random effects term formula. offset Vector containing model offsets (default = NULL). provided lmer() offset set offset. See lme4::lmer() test.stat Character value specifying test statistic. Current options \"Wald\" type 2 Wald Chi square test using code derived modified car::Anova improve speed matrix tests. \"F\" conditional F tests using Saiterthwaite's method approximated Df. uses lmerTest::lmer somewhat slower. reduced Optional reduced model formula. chosen, likelihood ratio test used calculate p-values instead default Wald type 2 Chi-squared test. modelData Optional dataframe. Default generated call expand.grid using levels variables formula. Used calculate model predictions (estimated means & 95% CI) plotting via modelPlot. can therefore used add/remove points modelPlot. designMatrix Optional custom design matrix generated call model.matrix using modelData FEformula. Used calculate model predictions plotting. control lmer optimizer control (default = lmerControl()). See lme4::lmerControl(). cores number cores use parallelisation. Default = 1. removeSingles whether remove individuals repeated measures (default = FALSE) verbose Logical whether display messaging (default = TRUE) returnList Logical whether return results list lmmSeq object (default = FALSE). Helpful debugging. progress Logical whether display progress bar ... parameters passed lmerTest::lmer(). available test.stat = \"F\".","code":""},{"path":"/reference/lmmSeq.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Linear mixed models for data matrix — lmmSeq","text":"Returns S4 class lmmSeq object results gene-wise linear mixed models; list results returnList TRUE.","code":""},{"path":"/reference/lmmSeq.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Linear mixed models for data matrix — lmmSeq","text":"default, p-values model term computed using Wald type 2 Chi-squared test per car::Anova(). underlying code optimised speed. However, reduced model formula specified setting reduced, likelihood ratio test (LRT) performed instead using anova. double computation time since two LMM fitted gene. LRT, models compared optimised maximum likelihood REML (REML=FALSE). Two key methods used speed computation beyond simple parallelisation. first speed lme4::lmer() calling lme4::lFormula() start updating lFormula output new data. 2nd speed optimised code repeated type 2 Wald Chi-squared tests (original code derived car::Anova). example, elements hypothesis matrices generated reduce unnecessarily repetitive computation, generation p-values Chi-squared values vectorised performed end. F-tests using lmerTest package optimised therefore slower. Parallelisation performed using parallel::mclapply unix/mac parallel::parLapply windows. Progress bars use pbmcapply::pbmclapply unix/mac pbapply::pblapply windows.","code":""},{"path":"/reference/lmmSeq.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Linear mixed models for data matrix — lmmSeq","text":"","code":"data(PEAC_minimal_load) logtpm <- log2(tpm +1) lmmtest <- lmmSeq(~ Timepoint * EULAR_6m + (1 | PATID),                      maindata = logtpm[1:2, ],                      metadata = metadata,                      verbose = FALSE) names(attributes(lmmtest)) #>  [1] \"info\"      \"formula\"   \"stats\"     \"predict\"   \"reduced\"   \"maindata\"  #>  [7] \"metadata\"  \"modelData\" \"optInfo\"   \"errors\"    \"vars\"      \"class\""},{"path":"/reference/maPlot.html","id":null,"dir":"Reference","previous_headings":"","what":"MA plots — maPlot","title":"MA plots — maPlot","text":"MA plots","code":""},{"path":"/reference/maPlot.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"MA plots — maPlot","text":"","code":"maPlot(   object,   x1var,   x2var,   x1Values = NULL,   x2Values = NULL,   pCutoff = 0.01,   plotCutoff = 1,   zeroCountCutoff = 50,   colours = c(\"grey\", \"midnightblue\", \"mediumvioletred\", \"goldenrod\"),   labels = c(),   fontSize = 12,   labelFontSize = 4,   useAdjusted = FALSE,   graphics = \"ggplot\",   verbose = FALSE )"},{"path":"/reference/maPlot.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"MA plots — maPlot","text":"object glmmSeq object created glmmSeq::glmmSeq(). x1var name first (inner) x parameter x2var name second (outer) x parameter x1Values Timepoints categories x1var used calculate fold change. NULL first two levels x1var used. x2Values Categories x2var compared x y axis. pCutoff significance cut-colour-coding (default=0.01) plotCutoff probes include significance cut-(default=1 markers) zeroCountCutoff probes include minimum counts cut-(default=50) colours Vector colours use significance groups labels Row names indices label plot fontSize Font size labelFontSize Font size labels useAdjusted whether use adjusted p-values (must q-values object) graphics Either \"ggplot\" \"plotly\" verbose Whether print statistics","code":""},{"path":"/reference/maPlot.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"MA plots — maPlot","text":"List three plots. One plot x2Value one combined figure","code":""},{"path":"/reference/maPlot.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"MA plots — maPlot","text":"","code":"data(PEAC_minimal_load)  disp <- apply(tpm, 1, function(x){ (var(x, na.rm=TRUE)-mean(x, na.rm=TRUE))/(mean(x, na.rm=TRUE)**2) })  resultTable <- glmmSeq(~ Timepoint * EULAR_6m + (1 | PATID),                        countdata = tpm[1:5, ],                        metadata = metadata,                        dispersion = disp) #>  #> n = 123 samples, 82 individuals #> Time difference of 0.2990222 secs  plots <- maPlot(resultTable,                 x1var='Timepoint',                 x2var='EULAR_6m',                 x2Values=c('Good', 'Non-response'),                 graphics=\"plotly\")  plots$combined  {\"x\":{\"data\":[{\"x\":[2.59173993133806,1.66750817051586],\"y\":[-0.402304397173844,0.836420750437364],\"mode\":\"markers\",\"marker\":{\"color\":\"rgba(190,190,190,1)\",\"size\":8,\"line\":{\"color\":\"white\",\"width\":0.5}},\"text\":[\"MS4A1\",\"ADAM12\"],\"hoverinfo\":[\"text\",\"text\"],\"showlegend\":false,\"type\":\"scatter\",\"name\":\"Not Significant\",\"textfont\":{\"color\":\"rgba(190,190,190,1)\"},\"error_y\":{\"color\":\"rgba(190,190,190,1)\"},\"error_x\":{\"color\":\"rgba(190,190,190,1)\"},\"line\":{\"color\":\"rgba(190,190,190,1)\"},\"xaxis\":\"x\",\"yaxis\":\"y\",\"frame\":null},{\"x\":[3.97746949765782],\"y\":[1.4446570289101],\"mode\":\"markers\",\"marker\":{\"color\":\"rgba(25,25,112,1)\",\"size\":8,\"line\":{\"color\":\"white\",\"width\":0.5}},\"text\":\"IGHV3-49\",\"hoverinfo\":\"text\",\"showlegend\":false,\"type\":\"scatter\",\"name\":\"P_Timepoint < 0.01\",\"textfont\":{\"color\":\"rgba(25,25,112,1)\"},\"error_y\":{\"color\":\"rgba(25,25,112,1)\"},\"error_x\":{\"color\":\"rgba(25,25,112,1)\"},\"line\":{\"color\":\"rgba(25,25,112,1)\"},\"xaxis\":\"x\",\"yaxis\":\"y\",\"frame\":null},{\"x\":[3.05860940360904,5.9461792685127],\"y\":[0.710023825674319,0.18499576274843],\"mode\":\"markers\",\"marker\":{\"color\":\"rgba(199,21,133,1)\",\"size\":8,\"line\":{\"color\":\"white\",\"width\":0.5}},\"text\":[\"IGHV7-4-1\",\"IGHV3-23\"],\"hoverinfo\":[\"text\",\"text\"],\"showlegend\":false,\"type\":\"scatter\",\"name\":\"P_EULAR_6m < 0.01 (up in Non-response)\",\"textfont\":{\"color\":\"rgba(199,21,133,1)\"},\"error_y\":{\"color\":\"rgba(199,21,133,1)\"},\"error_x\":{\"color\":\"rgba(199,21,133,1)\"},\"line\":{\"color\":\"rgba(199,21,133,1)\"},\"xaxis\":\"x\",\"yaxis\":\"y\",\"frame\":null},{\"x\":[2.59173993133806,1.66750817051586],\"y\":[-1.62012242287442,-1.04842131786371],\"mode\":\"markers\",\"marker\":{\"color\":\"rgba(190,190,190,1)\",\"size\":8,\"line\":{\"color\":\"white\",\"width\":0.5}},\"text\":[\"MS4A1\",\"ADAM12\"],\"hoverinfo\":[\"text\",\"text\"],\"type\":\"scatter\",\"name\":\"Not Significant\",\"textfont\":{\"color\":\"rgba(190,190,190,1)\"},\"error_y\":{\"color\":\"rgba(190,190,190,1)\"},\"error_x\":{\"color\":\"rgba(190,190,190,1)\"},\"line\":{\"color\":\"rgba(190,190,190,1)\"},\"xaxis\":\"x2\",\"yaxis\":\"y2\",\"frame\":null},{\"x\":[3.97746949765782],\"y\":[3.66823176181332],\"mode\":\"markers\",\"marker\":{\"color\":\"rgba(25,25,112,1)\",\"size\":8,\"line\":{\"color\":\"white\",\"width\":0.5}},\"text\":\"IGHV3-49\",\"hoverinfo\":\"text\",\"type\":\"scatter\",\"name\":\"P_Timepoint < 0.01\",\"textfont\":{\"color\":\"rgba(25,25,112,1)\"},\"error_y\":{\"color\":\"rgba(25,25,112,1)\"},\"error_x\":{\"color\":\"rgba(25,25,112,1)\"},\"line\":{\"color\":\"rgba(25,25,112,1)\"},\"xaxis\":\"x2\",\"yaxis\":\"y2\",\"frame\":null},{\"x\":[3.05860940360904,5.9461792685127],\"y\":[2.70518877096958,3.64716567160521],\"mode\":\"markers\",\"marker\":{\"color\":\"rgba(199,21,133,1)\",\"size\":8,\"line\":{\"color\":\"white\",\"width\":0.5}},\"text\":[\"IGHV7-4-1\",\"IGHV3-23\"],\"hoverinfo\":[\"text\",\"text\"],\"type\":\"scatter\",\"name\":\"P_EULAR_6m < 0.01 (up in Non-response)\",\"textfont\":{\"color\":\"rgba(199,21,133,1)\"},\"error_y\":{\"color\":\"rgba(199,21,133,1)\"},\"error_x\":{\"color\":\"rgba(199,21,133,1)\"},\"line\":{\"color\":\"rgba(199,21,133,1)\"},\"xaxis\":\"x2\",\"yaxis\":\"y2\",\"frame\":null}],\"layout\":{\"xaxis\":{\"domain\":[0,1],\"automargin\":true,\"color\":\"black\",\"anchor\":\"y\"},\"xaxis2\":{\"domain\":[0,1],\"automargin\":true,\"color\":\"black\",\"anchor\":\"y2\"},\"yaxis2\":{\"domain\":[0,0.4],\"automargin\":true,\"title\":\"log2(Fold Change)<br />Timepoint: 0 vs 6\",\"color\":\"black\",\"anchor\":\"x2\"},\"yaxis\":{\"domain\":[0.6,1],\"automargin\":true,\"title\":\"log2(Fold Change)<br />Timepoint: 0 vs 6\",\"color\":\"black\",\"anchor\":\"x\"},\"annotations\":[{\"x\":0,\"y\":0.45,\"text\":\"Good\",\"showarrow\":false,\"xref\":\"paper\",\"yref\":\"paper\",\"font\":{\"size\":15}},{\"x\":0,\"y\":1.01,\"text\":\"Non-response\",\"showarrow\":false,\"xref\":\"paper\",\"yref\":\"paper\",\"font\":{\"size\":15}}],\"shapes\":[],\"images\":[],\"margin\":{\"b\":40,\"l\":60,\"t\":25,\"r\":10},\"title\":\"MA Plots\",\"font\":{\"size\":12},\"legend\":{\"x\":1,\"y\":0.5,\"font\":{\"color\":\"black\"},\"xanchor\":\"right\",\"yanchor\":\"center\"},\"hovermode\":\"closest\",\"showlegend\":true},\"attrs\":{\"4edb710a9171\":{\"x\":{},\"y\":{},\"mode\":\"markers\",\"marker\":{\"size\":8,\"line\":{\"width\":0.5,\"color\":\"white\"}},\"text\":[\"MS4A1\",\"ADAM12\",\"IGHV7-4-1\",\"IGHV3-49\",\"IGHV3-23\"],\"hoverinfo\":\"text\",\"showlegend\":false,\"color\":{},\"colors\":[\"grey\",\"midnightblue\",\"mediumvioletred\",\"goldenrod\"],\"alpha_stroke\":1,\"sizes\":[10,100],\"spans\":[1,20],\"type\":\"scatter\"},\"4edb6cd2cbb1\":{\"x\":{},\"y\":{},\"mode\":\"markers\",\"marker\":{\"size\":8,\"line\":{\"width\":0.5,\"color\":\"white\"}},\"text\":[\"MS4A1\",\"ADAM12\",\"IGHV7-4-1\",\"IGHV3-49\",\"IGHV3-23\"],\"hoverinfo\":\"text\",\"color\":{},\"colors\":[\"grey\",\"midnightblue\",\"mediumvioletred\",\"goldenrod\"],\"alpha_stroke\":1,\"sizes\":[10,100],\"spans\":[1,20],\"type\":\"scatter\"}},\"source\":\"A\",\"config\":{\"modeBarButtonsToAdd\":[\"hoverclosest\",\"hovercompare\"],\"showSendToCloud\":false},\"highlight\":{\"on\":\"plotly_click\",\"persistent\":false,\"dynamic\":false,\"selectize\":false,\"opacityDim\":0.2,\"selected\":{\"opacity\":1},\"debounce\":0},\"subplot\":true,\"shinyEvents\":[\"plotly_hover\",\"plotly_click\",\"plotly_selected\",\"plotly_relayout\",\"plotly_brushed\",\"plotly_brushing\",\"plotly_clickannotation\",\"plotly_doubleclick\",\"plotly_deselect\",\"plotly_afterplot\",\"plotly_sunburstclick\"],\"base_url\":\"https://plot.ly\"},\"evals\":[],\"jsHooks\":[]}"},{"path":"/reference/metadata.html","id":null,"dir":"Reference","previous_headings":"","what":"Minimal metadata from PEAC — metadata","title":"Minimal metadata from PEAC — metadata","text":"Minimal metadata paired longitudinal response analysis.","code":""},{"path":"/reference/metadata.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Minimal metadata from PEAC — metadata","text":"","code":"metadata"},{"path":"/reference/metadata.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"Minimal metadata from PEAC — metadata","text":"data frame PATID Id matching patients Timepoint timepoints EULAR_6m response data","code":""},{"path":"/reference/modelPlot.html","id":null,"dir":"Reference","previous_headings":"","what":"Mixed model effects plot — modelPlot","title":"Mixed model effects plot — modelPlot","text":"Plot show differences groups time using base graphics.","code":""},{"path":"/reference/modelPlot.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Mixed model effects plot — modelPlot","text":"","code":"modelPlot(   object,   geneName = NULL,   x1var = NULL,   x2var = NULL,   x2shift = NULL,   xlab = NA,   ylab = geneName,   plab = NULL,   title = geneName,   logTransform = is(object, \"GlmmSeq\"),   shapes = 21,   colours = \"grey60\",   lineColours = \"grey60\",   markerSize = 0.5,   fontSize = NULL,   alpha = 0.7,   addModel = TRUE,   addPoints = TRUE,   modelSize = 2,   modelColours = \"royalblue\",   modelLineSize = 1,   modelLineColours = modelColours,   errorBarLwd = 2.5,   errorBarLength = 0.05,   ... )"},{"path":"/reference/modelPlot.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Mixed model effects plot — modelPlot","text":"object glmmSeq/lmmSeq object created glmmSeq::glmmSeq() glmmSeq::lmmSeq() geneName gene/row name plotted x1var name first (inner) x parameter, typically 'time'. anticipated different values matched ID. x2var name optional second (outer) x parameter, factor. x2shift Amount shift along x axis level x2var. default function arrange level x2var side side. Lower values x2shift x2shift = 0 can used overlap plots similar 'dodge' stagger . xlab Title x axis ylab Title y axis plab Optional character vector labels p-values. must align column names object@stats$pvals. title Plot title. NULL gene name used logTransform Whether perform log10 transform y axis shapes marker shapes (default=19) colours marker colours (default='red') vector named vector lineColours line colours (default='grey60') vector named vector markerSize Size markers (default=2) fontSize Plot font size alpha Line marker opacity (default=0.7) addModel Whether add fit model markers (default=TRUE) addPoints Whether add underlying data points (default=TRUE) modelSize Size model points (default=2) modelColours Colour model fit markers (default=\"black\") vector named vector modelLineSize Size model points (default=1) vector named vector modelLineColours Colour model fit lines. errorBarLwd Line width error bars errorBarLength Head width error bars ... parameters pass graphics::plot()","code":""},{"path":"/reference/modelPlot.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Mixed model effects plot — modelPlot","text":"Returns paired plot matched samples","code":""},{"path":"/reference/modelPlot.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Mixed model effects plot — modelPlot","text":"","code":"data(PEAC_minimal_load)  disp <- apply(tpm, 1, function(x){   (var(x, na.rm=TRUE)-mean(x, na.rm=TRUE))/(mean(x, na.rm=TRUE)**2) })  MS4A1glmm <- glmmSeq(~ Timepoint * EULAR_6m + (1 | PATID),                      countdata = tpm[1:2, ],                      metadata = metadata,                      dispersion = disp) #>  #> n = 123 samples, 82 individuals #> Time difference of 0.1045921 secs  modelPlot(object=MS4A1glmm,           geneName = 'MS4A1',           x1var = 'Timepoint',           x2var='EULAR_6m')"},{"path":"/reference/summary.lmmSeq.html","id":null,"dir":"Reference","previous_headings":"","what":"Summarise a 'glmmSeq'/'lmmSeq' object — summary.lmmSeq","title":"Summarise a 'glmmSeq'/'lmmSeq' object — summary.lmmSeq","text":"Summarise results glmmSeq lmmSeq analysis","code":""},{"path":"/reference/summary.lmmSeq.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Summarise a 'glmmSeq'/'lmmSeq' object — summary.lmmSeq","text":"","code":"# S3 method for lmmSeq summary(object, gene = NULL, digits = max(3L, getOption(\"digits\") - 3L), ...)  # S3 method for GlmmSeq summary(object, gene = NULL, ...)"},{"path":"/reference/summary.lmmSeq.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Summarise a 'glmmSeq'/'lmmSeq' object — summary.lmmSeq","text":"object object class \"GlmmSeq\" \"lmmSeq\" gene optional character value specifying single gene whose results summarised digits integer, used number formatting ... arguments passed methods","code":""},{"path":"/reference/summary.lmmSeq.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Summarise a 'glmmSeq'/'lmmSeq' object — summary.lmmSeq","text":"gene=NULL dataframe results genes returned. Otherwise output GLMM LMM model results single gene including coefficients, test statistics, p-values printed dataframe genes returned invisibly.","code":""},{"path":[]},{"path":"/reference/tpm.html","id":null,"dir":"Reference","previous_headings":"","what":"TPM count data from PEAC — tpm","title":"TPM count data from PEAC — tpm","text":"Transcripts Per Million (TPM) count data PEAC synovial biopsies.","code":""},{"path":"/reference/tpm.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"TPM count data from PEAC — tpm","text":"","code":"tpm"},{"path":"/reference/tpm.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"TPM count data from PEAC — tpm","text":"object class matrix (inherits array) 50 rows 123 columns.","code":""},{"path":[]},{"path":"/news/index.html","id":"id_29092022-0-5-5","dir":"Changelog","previous_headings":"","what":"glmmSeq v0.5.5","title":"glmmSeq v0.5.5","text":"Improve error handling genes give errors","code":""},{"path":[]},{"path":"/news/index.html","id":"id_25092022-0-5-4","dir":"Changelog","previous_headings":"","what":"glmmSeq v0.5.4","title":"glmmSeq v0.5.4","text":"Add option likelihood ratio test (LRT) glmmSeq() lmmSeq() Enable changing model formula, family control parameters refitting model single gene glmmRefit()","code":""},{"path":[]},{"path":"/news/index.html","id":"id_19092022-0-5-2","dir":"Changelog","previous_headings":"","what":"glmmSeq v0.5.2","title":"glmmSeq v0.5.2","text":"Fix passing ... parallelisation windows glmmSeq() & lmmSeq()","code":""},{"path":"/news/index.html","id":"glmmseq-v051","dir":"Changelog","previous_headings":"","what":"glmmSeq v0.5.1","title":"glmmSeq v0.5.1","text":"CRAN release: 2022-09-12","code":""},{"path":"/news/index.html","id":"id_02092022-0-5-1","dir":"Changelog","previous_headings":"","what":"glmmSeq v0.5.1","title":"glmmSeq v0.5.1","text":"Add option glmmSeq() use glmmTMB package fitting negative binomial GLMM (GLM family) models Add plab argument modelPlots customise p-value labels Add mean expression column meanExp results @stats$res slot","code":""},{"path":"/news/index.html","id":"glmmseq-v040","dir":"Changelog","previous_headings":"","what":"glmmSeq v0.4.0","title":"glmmSeq v0.4.0","text":"CRAN release: 2022-08-12","code":""},{"path":"/news/index.html","id":"id_10082022-0-4-0","dir":"Changelog","previous_headings":"","what":"glmmSeq v0.4.0","title":"glmmSeq v0.4.0","text":"speed enhancements lmmSeq() using lme4::modular code. Speed increase around 25%.","code":""},{"path":[]},{"path":"/news/index.html","id":"id_05082022-0-3-0","dir":"Changelog","previous_headings":"","what":"glmmSeq v0.3.0","title":"glmmSeq v0.3.0","text":"Significant update including output standard error fitted coefficients glmmSeq lmmSeq Add summary function glmmSeq lmmSeq display results individual gene Reorganised @stats slot output objects include information including DF Added option using Saiterthwaite’s DF method ANOVA type III tables option lmmSeq using lmerTest package Added lmmRefit function fit identical (g)lmer model. can passed emmeans package visualisation complex models. Separated modelPlots (base graphics) ggmodelPlots (ggplot2) Streamlined modelPlots allow simplest case gene ~ Time + (1 | ID)","code":""},{"path":[]},{"path":"/news/index.html","id":"id_16072022-0-2-2","dir":"Changelog","previous_headings":"","what":"glmmSeq v0.2.2","title":"glmmSeq v0.2.2","text":"Fast version lmmSeq(). Improves speed calculation type 2 Wald test. Overall speed increase 25-50%. Faster version glmmSeq() Automatically detects id column name RE term formula","code":""},{"path":[]},{"path":"/news/index.html","id":"id_11072022-0-2-1","dir":"Changelog","previous_headings":"","what":"glmmSeq v0.2.1","title":"glmmSeq v0.2.1","text":"Add ... option fcPlot passed plotly() ggplot() set annotationPosition=FALSE fcPlot arrows/connectors moved","code":""},{"path":"/news/index.html","id":"glmmseq-v020","dir":"Changelog","previous_headings":"","what":"glmmSeq v0.2.0","title":"glmmSeq v0.2.0","text":"CRAN release: 2022-07-11","code":""},{"path":"/news/index.html","id":"id_09072022-0-2-0","dir":"Changelog","previous_headings":"","what":"glmmSeq v0.2.0","title":"glmmSeq v0.2.0","text":"Add lmmSeq function gaussian linear mixed models","code":""},{"path":[]},{"path":"/news/index.html","id":"id_08072022-0-1-2","dir":"Changelog","previous_headings":"","what":"glmmSeq v0.1.2","title":"glmmSeq v0.1.2","text":"Fix CMD check errors","code":""},{"path":[]},{"path":[]},{"path":"/news/index.html","id":"bug-fixes-0-1-1","dir":"Changelog","previous_headings":"","what":"glmmSeq v0.1.1","title":"glmmSeq v0.1.1","text":"Fix colours pairedPlots modelPlots","code":""},{"path":"/news/index.html","id":"glmmseq-v010","dir":"Changelog","previous_headings":"","what":"glmmSeq v0.1.0","title":"glmmSeq v0.1.0","text":"CRAN release: 2021-03-30","code":""},{"path":[]},{"path":"/news/index.html","id":"features-0-1-0","dir":"Changelog","previous_headings":"","what":"glmmSeq v0.1.0","title":"glmmSeq v0.1.0","text":"Add progress bars glmmSeq functions Add option returnList return glmmSeq output list (make error catching easier)","code":""},{"path":"/news/index.html","id":"bug-fixes-0-1-0","dir":"Changelog","previous_headings":"","what":"glmmSeq v0.1.0","title":"glmmSeq v0.1.0","text":"Fix missing plots vignette","code":""},{"path":"/news/index.html","id":"glmmseq-v001","dir":"Changelog","previous_headings":"","what":"glmmSeq v0.0.1","title":"glmmSeq v0.0.1","text":"CRAN release: 2021-03-11","code":""},{"path":"/news/index.html","id":"id_05032021-0-0-1","dir":"Changelog","previous_headings":"","what":"glmmSeq v0.0.1","title":"glmmSeq v0.0.1","text":"initial build glmmSeq","code":""}]
