<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="description" content="Based on a 'GlmmSeq' or 'lmmSeq' class result object, this function attempts
to refit an identical model for a specific gene based on the data and fitting
parameters stored in the results object and refitting using either
lme4::glmer() for GlmmSeq objects or lmer() for lmmSeq objects. The
fitted model can then be passed on to other packages such as emmeans to
look at estimated marginal means for the model."><title>Refit mixed effects model — glmmRefit • glmmSeq</title><!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png"><link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png"><link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png"><link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png"><link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png"><link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png"><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.1.3/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.1.3/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- bootstrap-toc --><script src="https://cdn.rawgit.com/afeld/bootstrap-toc/v1.0.1/dist/bootstrap-toc.min.js"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Refit mixed effects model — glmmRefit"><meta property="og:description" content="Based on a 'GlmmSeq' or 'lmmSeq' class result object, this function attempts
to refit an identical model for a specific gene based on the data and fitting
parameters stored in the results object and refitting using either
lme4::glmer() for GlmmSeq objects or lmer() for lmmSeq objects. The
fitted model can then be passed on to other packages such as emmeans to
look at estimated marginal means for the model."><meta property="og:image" content="/logo.png"><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">glmmSeq</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.5.5</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item">
  <a class="nav-link" href="../articles/glmmSeq.html">Get started</a>
</li>
<li class="active nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
      </ul><form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off"></form>

      <ul class="navbar-nav"><li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/myles-lewis/glmmSeq/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div>

    
  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Refit mixed effects model</h1>
      <small class="dont-index">Source: <a href="https://github.com/myles-lewis/glmmSeq/blob/HEAD/R/glmmRefit.R" class="external-link"><code>R/glmmRefit.R</code></a></small>
      <div class="d-none name"><code>glmmRefit.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Based on a 'GlmmSeq' or 'lmmSeq' class result object, this function attempts
to refit an identical model for a specific gene based on the data and fitting
parameters stored in the results object and refitting using either
<code><a href="https://rdrr.io/pkg/lme4/man/glmer.html" class="external-link">lme4::glmer()</a></code> for <code>GlmmSeq</code> objects or <code>lmer()</code> for <code>lmmSeq</code> objects. The
fitted model can then be passed on to other packages such as <code>emmeans</code> to
look at estimated marginal means for the model.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">glmmRefit</span><span class="op">(</span><span class="va">object</span>, <span class="va">gene</span>, <span class="va">...</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S3 method for lmmSeq</span></span>
<span><span class="fu">glmmRefit</span><span class="op">(</span><span class="va">object</span>, <span class="va">gene</span>, formula <span class="op">=</span> <span class="va">object</span><span class="op">@</span><span class="va">formula</span>, <span class="va">...</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S3 method for GlmmSeq</span></span>
<span><span class="fu">glmmRefit</span><span class="op">(</span></span>
<span>  <span class="va">object</span>,</span>
<span>  <span class="va">gene</span>,</span>
<span>  formula <span class="op">=</span> <span class="va">object</span><span class="op">@</span><span class="va">formula</span>,</span>
<span>  control <span class="op">=</span> <span class="va">object</span><span class="op">@</span><span class="va">info</span><span class="op">$</span><span class="va">control</span>,</span>
<span>  family <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <dl><dt>object</dt>
<dd><p>A fitted results object of class <code>GlmmSeq</code> or <code>lmmSeq</code></p></dd>


<dt>gene</dt>
<dd><p>A character value specifying a single gene to extract a fitted
model for</p></dd>


<dt>...</dt>
<dd><p>Optional arguments passed to either <code><a href="https://rdrr.io/pkg/lme4/man/glmer.html" class="external-link">lme4::glmer()</a></code> or
<code><a href="https://rdrr.io/pkg/lme4/man/lmer.html" class="external-link">lme4::lmer()</a></code></p></dd>


<dt>formula</dt>
<dd><p>Optional formula to use when refitting model</p></dd>


<dt>control</dt>
<dd><p>Optional control parameters, see <code><a href="https://rdrr.io/pkg/lme4/man/lmerControl.html" class="external-link">lme4::lmerControl()</a></code> or
<code><a href="https://rdrr.io/pkg/lme4/man/lmerControl.html" class="external-link">lme4::glmerControl()</a></code></p></dd>


<dt>family</dt>
<dd><p>Optional GLM family when refitting GLMM using <code><a href="https://rdrr.io/pkg/lme4/man/glmer.html" class="external-link">lme4::glmer()</a></code>
or <code>glmmTMB()</code></p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    

<p>Fitted model of class <code>lmerMod</code> in the case of LMM, or <code>glmerMod</code> or
<code>glmmTMB</code> for a GLMM dependent on the original method.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">PEAC_minimal_load</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">disp</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/apply.html" class="external-link">apply</a></span><span class="op">(</span><span class="va">tpm</span>, <span class="fl">1</span>, <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span>  <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/cor.html" class="external-link">var</a></span><span class="op">(</span><span class="va">x</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">x</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span><span class="op">/</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">x</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">**</span><span class="fl">2</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">glmmtest</span> <span class="op">&lt;-</span> <span class="fu"><a href="glmmSeq.html">glmmSeq</a></span><span class="op">(</span><span class="op">~</span> <span class="va">Timepoint</span> <span class="op">*</span> <span class="va">EULAR_6m</span> <span class="op">+</span> <span class="op">(</span><span class="fl">1</span> <span class="op">|</span> <span class="va">PATID</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                     countdata <span class="op">=</span> <span class="va">tpm</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">2</span>, <span class="op">]</span>,</span></span>
<span class="r-in"><span>                     metadata <span class="op">=</span> <span class="va">metadata</span>,</span></span>
<span class="r-in"><span>                     dispersion <span class="op">=</span> <span class="va">disp</span>,</span></span>
<span class="r-in"><span>                     verbose <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># show summary for single gene</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">glmmtest</span>, <span class="st">"MS4A1"</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Generalised linear mixed model</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Method: lme4</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Family: Negative Binomial</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Formula: count ~ Timepoint + EULAR_6m + (1 | PATID) + Timepoint:EULAR_6m</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> &lt;environment: 0x7fd12830a4e0&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  Dispersion         AIC      logLik     meanExp </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    3.789428  898.682864 -441.341432    2.591740 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Fixed effects:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                                Estimate Std. Error</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> (Intercept)                     2.73637    0.33669</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Timepoint                       0.04908    0.08941</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> EULAR_6mModerate                0.19330    0.51103</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> EULAR_6mNon-response           -1.72376    0.67780</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Timepoint:EULAR_6mModerate     -0.21080    0.13478</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Timepoint:EULAR_6mNon-response  0.17462    0.16558</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Analysis of Deviance Table (Type II Wald chisquare tests)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                      Chisq Df Pr(&gt;Chisq)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Timepoint          0.01125  1    0.91554</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> EULAR_6m           5.68288  2    0.05834</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Timepoint:EULAR_6m 5.43787  2    0.06594</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># refit a single model using lme4::glmer()</span></span></span>
<span class="r-in"><span><span class="va">fit</span> <span class="op">&lt;-</span> <span class="fu">glmmRefit</span><span class="op">(</span><span class="va">glmmtest</span>, <span class="st">"MS4A1"</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> boundary (singular) fit: see help('isSingular')</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># refit model with reduced formula</span></span></span>
<span class="r-in"><span><span class="va">fit2</span> <span class="op">&lt;-</span> <span class="fu">glmmRefit</span><span class="op">(</span><span class="va">glmmtest</span>, <span class="st">"MS4A1"</span>,</span></span>
<span class="r-in"><span>                  formula <span class="op">=</span> <span class="va">count</span> <span class="op">~</span> <span class="va">Timepoint</span> <span class="op">+</span> <span class="va">EULAR_6m</span> <span class="op">+</span> <span class="op">(</span><span class="fl">1</span> <span class="op">|</span> <span class="va">PATID</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># LRT</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/stats/anova.html" class="external-link">anova</a></span><span class="op">(</span><span class="va">fit</span>, <span class="va">fit2</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Data: data</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Models:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> fit2: count ~ Timepoint + EULAR_6m + (1 | PATID)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> fit: count ~ Timepoint + EULAR_6m + (1 | PATID) + Timepoint:EULAR_6m</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      npar    AIC    BIC  logLik deviance  Chisq Df Pr(&gt;Chisq)  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> fit2    6 899.53 916.41 -443.77   887.53                       </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> fit     8 898.68 921.18 -441.34   882.68 4.8505  2    0.08846 .</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ---</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1</span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p></p><p>Developed by Myles Lewis, Katriona Goldmann, Elisabetta Sciacca.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.6.</p>
</div>

    </footer></div>

  

  

  </body></html>

