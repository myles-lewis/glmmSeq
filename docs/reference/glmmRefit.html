<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Refit mixed effects model — glmmRefit • glmmSeq</title>

<!-- favicons -->
<link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png" />
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png" />
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png" />
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png" />

<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->
<link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/flatly/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous" />


<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Refit mixed effects model — glmmRefit" />
<meta property="og:description" content="Based on a 'GlmmSeq' or 'lmmSeq' class result object, this function attempts
to refit an identical model for a specific gene based on the data and fitting
parameters stored in the results object and refitting using either
lme4::glmer() for GlmmSeq objects or lmer() for lmmSeq objects. The
fitted model can then be passed on to other packages such as emmeans to
look at estimated marginal means for the model." />
<meta property="og:image" content="/logo.png" />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">glmmSeq</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.5.4</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fa fa-home"></span>
     
  </a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="../articles/glmmSeq.html">
    <span class="fas fa-book"></span>
     
    Get Started
  </a>
</li>
<li>
  <a href="../news/index.html">
    <span class="fas fa-newspaper"></span>
     
    News
  </a>
</li>
<li>
  <a href="../reference/index.html">
    <span class="far fa-file-code"></span>
     
    Reference Manual
  </a>
</li>
<li>
  <a href="https://github.com/KatrionaGoldmann/glmmSeq">
    <span class="fab fa-github"></span>
     
    Github
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Refit mixed effects model</h1>
    <small class="dont-index">Source: <a href='https://github.com/KatrionaGoldmann/glmmSeq/blob/master/R/glmmRefit.R'><code>R/glmmRefit.R</code></a></small>
    <div class="hidden name"><code>glmmRefit.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Based on a 'GlmmSeq' or 'lmmSeq' class result object, this function attempts
to refit an identical model for a specific gene based on the data and fitting
parameters stored in the results object and refitting using either
<code><a href='https://rdrr.io/pkg/lme4/man/glmer.html'>lme4::glmer()</a></code> for <code>GlmmSeq</code> objects or <code>lmer()</code> for <code>lmmSeq</code> objects. The
fitted model can then be passed on to other packages such as <code>emmeans</code> to
look at estimated marginal means for the model.</p>
    </div>

    <pre class="usage"><span class='fu'>glmmRefit</span><span class='op'>(</span><span class='va'>object</span>, <span class='va'>gene</span>, <span class='va'>...</span><span class='op'>)</span>

<span class='co'># S3 method for lmmSeq</span>
<span class='fu'>glmmRefit</span><span class='op'>(</span><span class='va'>object</span>, <span class='va'>gene</span>, formula <span class='op'>=</span> <span class='va'>object</span><span class='op'>@</span><span class='va'>formula</span>, <span class='va'>...</span><span class='op'>)</span>

<span class='co'># S3 method for GlmmSeq</span>
<span class='fu'>glmmRefit</span><span class='op'>(</span>
  <span class='va'>object</span>,
  <span class='va'>gene</span>,
  formula <span class='op'>=</span> <span class='va'>object</span><span class='op'>@</span><span class='va'>formula</span>,
  control <span class='op'>=</span> <span class='va'>object</span><span class='op'>@</span><span class='va'>info</span><span class='op'>$</span><span class='va'>control</span>,
  family <span class='op'>=</span> <span class='cn'>NULL</span>,
  <span class='va'>...</span>
<span class='op'>)</span></pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>object</th>
      <td><p>A fitted results object of class <code>GlmmSeq</code> or <code>lmmSeq</code></p></td>
    </tr>
    <tr>
      <th>gene</th>
      <td><p>A character value specifying a single gene to extract a fitted
model for</p></td>
    </tr>
    <tr>
      <th>...</th>
      <td><p>Optional arguments passed to either <code><a href='https://rdrr.io/pkg/lme4/man/glmer.html'>lme4::glmer()</a></code> or
<code><a href='https://rdrr.io/pkg/lme4/man/lmer.html'>lme4::lmer()</a></code></p></td>
    </tr>
    <tr>
      <th>formula</th>
      <td><p>Optional formula to use when refitting model</p></td>
    </tr>
    <tr>
      <th>control</th>
      <td><p>Optional control parameters, see <code><a href='https://rdrr.io/pkg/lme4/man/lmerControl.html'>lme4::lmerControl()</a></code> or
<code><a href='https://rdrr.io/pkg/lme4/man/lmerControl.html'>lme4::glmerControl()</a></code></p></td>
    </tr>
    <tr>
      <th>family</th>
      <td><p>Optional GLM family when refitting GLMM using <code><a href='https://rdrr.io/pkg/lme4/man/glmer.html'>lme4::glmer()</a></code>
or <code>glmmTMB()</code></p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>Fitted model of class <code>lmerMod</code> in the case of LMM, or <code>glmerMod</code> or
<code>glmmTMB</code> for a GLMM dependent on the original method.</p>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><span class='r-in'><span class='fu'><a href='https://rdrr.io/r/utils/data.html'>data</a></span><span class='op'>(</span><span class='va'>PEAC_minimal_load</span><span class='op'>)</span></span>
<span class='r-in'><span class='va'>disp</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/apply.html'>apply</a></span><span class='op'>(</span><span class='va'>tpm</span>, <span class='fl'>1</span>, <span class='kw'>function</span><span class='op'>(</span><span class='va'>x</span><span class='op'>)</span> <span class='op'>{</span></span>
<span class='r-in'>  <span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/stats/cor.html'>var</a></span><span class='op'>(</span><span class='va'>x</span>, na.rm <span class='op'>=</span> <span class='cn'>TRUE</span><span class='op'>)</span><span class='op'>-</span><span class='fu'><a href='https://rdrr.io/r/base/mean.html'>mean</a></span><span class='op'>(</span><span class='va'>x</span>, na.rm <span class='op'>=</span> <span class='cn'>TRUE</span><span class='op'>)</span><span class='op'>)</span><span class='op'>/</span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/mean.html'>mean</a></span><span class='op'>(</span><span class='va'>x</span>, na.rm <span class='op'>=</span> <span class='cn'>TRUE</span><span class='op'>)</span><span class='op'>**</span><span class='fl'>2</span><span class='op'>)</span></span>
<span class='r-in'><span class='op'>}</span><span class='op'>)</span></span>
<span class='r-in'><span class='va'>glmmtest</span> <span class='op'>&lt;-</span> <span class='fu'><a href='glmmSeq.html'>glmmSeq</a></span><span class='op'>(</span><span class='op'>~</span> <span class='va'>Timepoint</span> <span class='op'>*</span> <span class='va'>EULAR_6m</span> <span class='op'>+</span> <span class='op'>(</span><span class='fl'>1</span> <span class='op'>|</span> <span class='va'>PATID</span><span class='op'>)</span>,</span>
<span class='r-in'>                     countdata <span class='op'>=</span> <span class='va'>tpm</span><span class='op'>[</span><span class='fl'>1</span><span class='op'>:</span><span class='fl'>2</span>, <span class='op'>]</span>,</span>
<span class='r-in'>                     metadata <span class='op'>=</span> <span class='va'>metadata</span>,</span>
<span class='r-in'>                     dispersion <span class='op'>=</span> <span class='va'>disp</span>,</span>
<span class='r-in'>                     verbose <span class='op'>=</span> <span class='cn'>FALSE</span><span class='op'>)</span></span>
<span class='r-in'></span>
<span class='r-in'><span class='co'># show summary for single gene</span></span>
<span class='r-in'><span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span><span class='op'>(</span><span class='va'>glmmtest</span>, <span class='st'>"MS4A1"</span><span class='op'>)</span></span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> Generalised linear mixed model</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> Method: lme4</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> Family: Negative Binomial</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> Formula: count ~ Timepoint + EULAR_6m + (1 | PATID) + Timepoint:EULAR_6m</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> &lt;environment: 0x7fb0d40231d8&gt;</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span>  Dispersion         AIC      logLik     meanExp </span>
<span class='r-out co'><span class='r-pr'>#&gt;</span>    3.789428  898.682864 -441.341432    2.591740 </span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> </span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> Fixed effects:</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span>                                Estimate Std. Error</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> (Intercept)                     2.73637    0.33669</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> Timepoint                       0.04908    0.08941</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> EULAR_6mModerate                0.19330    0.51103</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> EULAR_6mNon-response           -1.72376    0.67780</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> Timepoint:EULAR_6mModerate     -0.21080    0.13478</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> Timepoint:EULAR_6mNon-response  0.17462    0.16558</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> </span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> Analysis of Deviance Table (Type II Wald chisquare tests)</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span>                      Chisq Df Pr(&gt;Chisq)</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> Timepoint          0.01125  1    0.91554</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> EULAR_6m           5.68288  2    0.05834</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> Timepoint:EULAR_6m 5.43787  2    0.06594</span>
<span class='r-in'></span>
<span class='r-in'><span class='co'># refit a single model using lme4::glmer()</span></span>
<span class='r-in'><span class='va'>fit</span> <span class='op'>&lt;-</span> <span class='fu'>glmmRefit</span><span class='op'>(</span><span class='va'>glmmtest</span>, <span class='st'>"MS4A1"</span><span class='op'>)</span></span>
<span class='r-msg co'><span class='r-pr'>#&gt;</span> boundary (singular) fit: see ?isSingular</span>
<span class='r-in'></span>
<span class='r-in'><span class='co'># refit model with reduced formula</span></span>
<span class='r-in'><span class='va'>fit2</span> <span class='op'>&lt;-</span> <span class='fu'>glmmRefit</span><span class='op'>(</span><span class='va'>glmmtest</span>, <span class='st'>"MS4A1"</span>,</span>
<span class='r-in'>                  formula <span class='op'>=</span> <span class='va'>count</span> <span class='op'>~</span> <span class='va'>Timepoint</span> <span class='op'>+</span> <span class='va'>EULAR_6m</span> <span class='op'>+</span> <span class='op'>(</span><span class='fl'>1</span> <span class='op'>|</span> <span class='va'>PATID</span><span class='op'>)</span><span class='op'>)</span></span>
<span class='r-in'></span>
<span class='r-in'><span class='co'># LRT</span></span>
<span class='r-in'><span class='fu'><a href='https://rdrr.io/r/stats/anova.html'>anova</a></span><span class='op'>(</span><span class='va'>fit</span>, <span class='va'>fit2</span><span class='op'>)</span></span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> Data: data</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> Models:</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> fit2: count ~ Timepoint + EULAR_6m + (1 | PATID)</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> fit: count ~ Timepoint + EULAR_6m + (1 | PATID) + Timepoint:EULAR_6m</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span>      npar    AIC    BIC  logLik deviance  Chisq Df Pr(&gt;Chisq)  </span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> fit2    6 899.53 916.41 -443.77   887.53                       </span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> fit     8 898.68 921.18 -441.34   882.68 4.8505  2    0.08846 .</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> ---</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1</span>
<span class='r-in'></span>
</pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.7.2/css/all.css">

<style>
  #left {
    float:left;
  }
  #right {
    width:100%;
    position:relative;
    text-align:right;
    align:right;
    float:right;
  }
  *.icon-grey {color: lightgrey}
  j {
    text-align:center;
    vertical-align:middle;
    position: relative;
    padding-bottom: 12px;
  }
  .smadge:after{
    content:"EMR";
    position: absolute;
    background: lightgrey;
    height:1.2rem;
    top:1rem;
    right:-1rem;
    width:2.3rem;
    text-align: center;
    line-height: 1rem;;
    font-size: 1rem;
    color: #ff3333;
    border-radius: 10%;
  }
  .bladge:after{
    content:"C4TB";
    position: absolute;
    background: lightgrey;
    height:1.2rem;
    top:1rem;
    right:-1rem;
    width:2.7rem;
    text-align: center;
    line-height: 1rem;;
    font-size: 1rem;
    color: #ff3333;
    border-radius: 10%;
  }
</style>

<div id="left">
Developed by the <a href="https://www.qmul.ac.uk/whri/emr/">Centre for Experimental Medicine & Rheumatology</a>, QMUL
</div>

<div id="right">
<a href="https://www.qmul.ac.uk/whri/emr/"><j class="fa fa-university fa-2x  icon-grey smadge" aria-hidden="false" style="color:#ff3333"></j></a>
<span style="margin-left:1rem"></span>

<a href="https://www.qmul.ac.uk/c4tb/"><j class="fa fa-university fa-2x  icon-grey bladge" aria-hidden="false" style="color:#ff3333"></j></a>
<span style="margin-left:1rem"></span>

<a href="mailto:k.goldmann@qmul.ac.uk" class="fas fa-envelope fa-2x" style="color:#ff3333">
</a><span style="margin-left:1rem"></span>

<a href="https://github.com/KatrionaGoldmann"><i class="fab fa-github fa-2x" style="color:#ff3333"></i></a>
<span style="margin-left:1rem"></span>

<a href="https://twitter.com/EMR_QMUL"><i class="fab fa-twitter fa-2x" style="color:#ff3333"></i></a>
</div>

      </footer>
   </div>

  


  </body>
</html>


